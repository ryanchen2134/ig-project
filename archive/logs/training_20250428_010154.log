2025-04-28 01:01:54,383 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 01:01:54,383 - contrastive_training - INFO - Training parameters:
2025-04-28 01:01:54,383 - contrastive_training - INFO - Backbone architecture: resnet18
2025-04-28 01:01:54,384 - contrastive_training - INFO - Batch size: 32
2025-04-28 01:01:54,384 - contrastive_training - INFO - Embedding dimension: 128
2025-04-28 01:01:54,384 - contrastive_training - INFO - Learning rate: 5e-05
2025-04-28 01:01:54,384 - contrastive_training - INFO - Weight decay: 0.001
2025-04-28 01:01:54,384 - contrastive_training - INFO - Max epochs: 200
2025-04-28 01:01:54,384 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 01:01:54,384 - contrastive_training - INFO - NT-Xent temperature: 0.03
2025-04-28 01:01:54,384 - contrastive_training - INFO - Hard negative weight: 0.4
2025-04-28 01:01:54,384 - contrastive_training - INFO - Mixup alpha: 0.4
2025-04-28 01:01:54,411 - contrastive_training - INFO - Using device: cuda
2025-04-28 01:01:54,411 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 01:01:54,411 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 01:01:54,779 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 01:01:54,800 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 01:02:12,708 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 01:02:12,708 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 01:02:12,708 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 01:02:12,708 - contrastive_training - INFO - Actual batch sizes - Train: 32, Val: 32, Test: 32
2025-04-28 01:02:12,708 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 01:02:12,837 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-04-28 01:02:12,838 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 01:02:12,838 - contrastive_training - INFO - Starting training...
2025-04-28 01:02:12,956 - contrastive_training - INFO - Starting training on device: cuda
2025-04-28 01:02:12,956 - contrastive_training - INFO - Number of training batches: 28
2025-04-28 01:02:12,958 - contrastive_training - INFO - Number of validation batches: 6
2025-04-28 01:03:17,948 - contrastive_training - INFO - Current Learning rate: 0.000000
2025-04-28 01:03:17,948 - contrastive_training - INFO - Epoch [1/200], Train Loss: 7.3487, Val Loss: 6.0521, Time: 64.99s
2025-04-28 01:03:17,948 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 01:04:00,747 - contrastive_training - INFO - Validation loss improved to 6.0521
2025-04-28 01:05:05,275 - contrastive_training - INFO - Current Learning rate: 0.000005
2025-04-28 01:05:05,275 - contrastive_training - INFO - Epoch [2/200], Train Loss: 7.5974, Val Loss: 5.9121, Time: 64.53s
2025-04-28 01:05:05,277 - contrastive_training - INFO - Validation loss improved to 5.9121
2025-04-28 01:06:09,887 - contrastive_training - INFO - Current Learning rate: 0.000010
2025-04-28 01:06:09,887 - contrastive_training - INFO - Epoch [3/200], Train Loss: 7.2516, Val Loss: 5.5284, Time: 64.61s
2025-04-28 01:06:09,888 - contrastive_training - INFO - Validation loss improved to 5.5284
2025-04-28 01:07:14,455 - contrastive_training - INFO - Current Learning rate: 0.000015
2025-04-28 01:07:14,455 - contrastive_training - INFO - Epoch [4/200], Train Loss: 7.0354, Val Loss: 5.1759, Time: 64.57s
2025-04-28 01:07:14,456 - contrastive_training - INFO - Validation loss improved to 5.1759
2025-04-28 01:08:18,823 - contrastive_training - INFO - Current Learning rate: 0.000020
2025-04-28 01:08:18,823 - contrastive_training - INFO - Epoch [5/200], Train Loss: 6.6556, Val Loss: 4.8333, Time: 64.37s
2025-04-28 01:08:18,955 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_5.pth
2025-04-28 01:08:18,955 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 01:08:52,703 - contrastive_training - INFO - Validation loss improved to 4.8333
2025-04-28 01:09:57,656 - contrastive_training - INFO - Current Learning rate: 0.000025
2025-04-28 01:09:57,656 - contrastive_training - INFO - Epoch [6/200], Train Loss: 6.2667, Val Loss: 4.5357, Time: 64.95s
2025-04-28 01:09:57,657 - contrastive_training - INFO - Validation loss improved to 4.5357
2025-04-28 01:11:02,194 - contrastive_training - INFO - Current Learning rate: 0.000030
2025-04-28 01:11:02,195 - contrastive_training - INFO - Epoch [7/200], Train Loss: 5.9446, Val Loss: 4.3141, Time: 64.54s
2025-04-28 01:11:02,195 - contrastive_training - INFO - Validation loss improved to 4.3141
2025-04-28 01:12:06,562 - contrastive_training - INFO - Current Learning rate: 0.000035
2025-04-28 01:12:06,562 - contrastive_training - INFO - Epoch [8/200], Train Loss: 5.5991, Val Loss: 4.1035, Time: 64.37s
2025-04-28 01:12:06,563 - contrastive_training - INFO - Validation loss improved to 4.1035
2025-04-28 01:13:10,973 - contrastive_training - INFO - Current Learning rate: 0.000040
2025-04-28 01:13:10,973 - contrastive_training - INFO - Epoch [9/200], Train Loss: 5.2085, Val Loss: 3.9400, Time: 64.41s
2025-04-28 01:13:10,974 - contrastive_training - INFO - Validation loss improved to 3.9400
2025-04-28 01:14:15,340 - contrastive_training - INFO - Current Learning rate: 0.000045
2025-04-28 01:14:15,340 - contrastive_training - INFO - Epoch [10/200], Train Loss: 5.0079, Val Loss: 3.8401, Time: 64.37s
2025-04-28 01:14:15,472 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_10.pth
2025-04-28 01:14:15,473 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 01:14:49,078 - contrastive_training - INFO - Validation loss improved to 3.8401
2025-04-28 01:15:53,514 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:15:53,514 - contrastive_training - INFO - Epoch [11/200], Train Loss: 4.7136, Val Loss: 3.7881, Time: 64.44s
2025-04-28 01:15:53,516 - contrastive_training - INFO - Validation loss improved to 3.7881
2025-04-28 01:16:57,680 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:16:57,682 - contrastive_training - INFO - Epoch [12/200], Train Loss: 4.5841, Val Loss: 3.7528, Time: 64.17s
2025-04-28 01:16:57,682 - contrastive_training - INFO - Validation loss improved to 3.7528
2025-04-28 01:18:02,071 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:18:02,072 - contrastive_training - INFO - Epoch [13/200], Train Loss: 4.2831, Val Loss: 3.7173, Time: 64.39s
2025-04-28 01:18:02,072 - contrastive_training - INFO - Validation loss improved to 3.7173
2025-04-28 01:19:06,647 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:19:06,647 - contrastive_training - INFO - Epoch [14/200], Train Loss: 4.1303, Val Loss: 3.6842, Time: 64.58s
2025-04-28 01:19:06,648 - contrastive_training - INFO - Validation loss improved to 3.6842
2025-04-28 01:20:11,030 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:20:11,031 - contrastive_training - INFO - Epoch [15/200], Train Loss: 4.0469, Val Loss: 3.6703, Time: 64.38s
2025-04-28 01:20:11,163 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_15.pth
2025-04-28 01:20:11,163 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 01:20:44,689 - contrastive_training - INFO - Validation loss improved to 3.6703
2025-04-28 01:21:49,402 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:21:49,403 - contrastive_training - INFO - Epoch [16/200], Train Loss: 3.9359, Val Loss: 3.6757, Time: 64.71s
2025-04-28 01:21:49,403 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 01:22:54,147 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:22:54,147 - contrastive_training - INFO - Epoch [17/200], Train Loss: 3.8890, Val Loss: 3.6557, Time: 64.74s
2025-04-28 01:22:54,149 - contrastive_training - INFO - Validation loss improved to 3.6557
2025-04-28 01:23:58,749 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:23:58,749 - contrastive_training - INFO - Epoch [18/200], Train Loss: 3.8188, Val Loss: 3.6486, Time: 64.60s
2025-04-28 01:23:58,749 - contrastive_training - INFO - Validation loss improved to 3.6486
2025-04-28 01:25:03,317 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:25:03,317 - contrastive_training - INFO - Epoch [19/200], Train Loss: 3.6432, Val Loss: 3.6215, Time: 64.57s
2025-04-28 01:25:03,318 - contrastive_training - INFO - Validation loss improved to 3.6215
2025-04-28 01:26:07,896 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:26:07,896 - contrastive_training - INFO - Epoch [20/200], Train Loss: 3.5688, Val Loss: 3.6516, Time: 64.58s
2025-04-28 01:26:08,021 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_20.pth
2025-04-28 01:26:08,021 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 01:26:41,740 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 01:27:46,294 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:27:46,294 - contrastive_training - INFO - Epoch [21/200], Train Loss: 3.5531, Val Loss: 3.6978, Time: 64.55s
2025-04-28 01:27:46,294 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 01:28:50,642 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:28:50,644 - contrastive_training - INFO - Epoch [22/200], Train Loss: 3.4536, Val Loss: 3.7248, Time: 64.35s
2025-04-28 01:28:50,644 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 01:29:55,225 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:29:55,225 - contrastive_training - INFO - Epoch [23/200], Train Loss: 3.4647, Val Loss: 3.7195, Time: 64.58s
2025-04-28 01:29:55,225 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 01:30:59,411 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 01:30:59,412 - contrastive_training - INFO - Epoch [24/200], Train Loss: 3.3294, Val Loss: 3.7460, Time: 64.19s
2025-04-28 01:30:59,412 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 01:32:03,828 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:32:03,828 - contrastive_training - INFO - Epoch [25/200], Train Loss: 3.1211, Val Loss: 3.8234, Time: 64.42s
2025-04-28 01:32:03,958 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_25.pth
2025-04-28 01:32:03,958 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 01:32:37,621 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 01:33:42,380 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:33:42,380 - contrastive_training - INFO - Epoch [26/200], Train Loss: 3.0908, Val Loss: 3.8548, Time: 64.76s
2025-04-28 01:33:42,380 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 01:34:46,754 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:34:46,754 - contrastive_training - INFO - Epoch [27/200], Train Loss: 3.0834, Val Loss: 3.8922, Time: 64.37s
2025-04-28 01:34:46,754 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 01:35:51,168 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:35:51,169 - contrastive_training - INFO - Epoch [28/200], Train Loss: 3.0695, Val Loss: 3.9354, Time: 64.42s
2025-04-28 01:35:51,169 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 01:36:55,930 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:36:55,930 - contrastive_training - INFO - Epoch [29/200], Train Loss: 2.9900, Val Loss: 3.9230, Time: 64.76s
2025-04-28 01:36:55,931 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 01:38:00,704 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:38:00,704 - contrastive_training - INFO - Epoch [30/200], Train Loss: 2.9586, Val Loss: 3.9028, Time: 64.77s
2025-04-28 01:38:00,830 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_30.pth
2025-04-28 01:38:00,830 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 01:38:34,358 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 01:39:39,063 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:39:39,064 - contrastive_training - INFO - Epoch [31/200], Train Loss: 2.7886, Val Loss: 3.9544, Time: 64.71s
2025-04-28 01:39:39,064 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 01:40:43,597 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:40:43,597 - contrastive_training - INFO - Epoch [32/200], Train Loss: 2.7539, Val Loss: 4.0346, Time: 64.53s
2025-04-28 01:40:43,597 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 01:41:47,993 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:41:47,993 - contrastive_training - INFO - Epoch [33/200], Train Loss: 2.7493, Val Loss: 4.0652, Time: 64.40s
2025-04-28 01:41:47,993 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 01:42:52,586 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 01:42:52,586 - contrastive_training - INFO - Epoch [34/200], Train Loss: 2.6655, Val Loss: 4.1701, Time: 64.59s
2025-04-28 01:42:52,586 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 01:42:52,587 - contrastive_training - INFO - Early stopping triggered after 34 epochs
2025-04-28 01:42:52,635 - contrastive_training - INFO - Best model saved to checkpoints\best_model.pth
2025-04-28 01:42:52,637 - contrastive_training - INFO - 
Training Summary:
2025-04-28 01:42:52,637 - contrastive_training - INFO - Total training time: 2439.68 seconds
2025-04-28 01:42:52,637 - contrastive_training - INFO - Best validation loss: 3.6215 (achieved on epoch 19)
2025-04-28 01:42:52,637 - contrastive_training - INFO - Plotting training history...
2025-04-28 01:42:52,831 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 02:01:28,714 - contrastive_training - INFO - Training completed and model saved as contrastive_model_resnet18.pth!
2025-04-28 02:01:28,714 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 02:02:00,426 - contrastive_training - INFO - Test Loss: 3.9541
2025-04-28 02:02:31,769 - contrastive_training - INFO - Matching accuracy on test set: 4.26%
