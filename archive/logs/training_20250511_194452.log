2025-05-11 19:44:52,417 - contrastive_training - INFO - Random seeds set for reproducibility
2025-05-11 19:44:52,417 - contrastive_training - INFO - Training parameters:
2025-05-11 19:44:52,417 - contrastive_training - INFO - Backbone architecture: resnet18
2025-05-11 19:44:52,417 - contrastive_training - INFO - Batch size: 16
2025-05-11 19:44:52,417 - contrastive_training - INFO - Embedding dimension: 128
2025-05-11 19:44:52,417 - contrastive_training - INFO - Learning rate: 0.0001
2025-05-11 19:44:52,417 - contrastive_training - INFO - Weight decay: 0.0001
2025-05-11 19:44:52,417 - contrastive_training - INFO - Max epochs: 75
2025-05-11 19:44:52,417 - contrastive_training - INFO - Early stopping patience: 10
2025-05-11 19:44:52,417 - contrastive_training - INFO - NT-Xent temperature: 0.07
2025-05-11 19:44:52,417 - contrastive_training - INFO - Hard negative weight: 0.2
2025-05-11 19:44:52,417 - contrastive_training - INFO - Mixup alpha: 0.2
2025-05-11 19:44:52,429 - contrastive_training - INFO - Using device: cuda
2025-05-11 19:44:52,429 - contrastive_training - INFO - Data path: data/csv_files/data_cleaned.csv
2025-05-11 19:44:52,429 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-05-11 19:44:52,560 - contrastive_training - INFO - Dataset successfully loaded with 1177 samples
2025-05-11 19:44:52,580 - contrastive_training - INFO - Song embedding dimension: 64
2025-05-11 19:45:08,952 - contrastive_training - INFO - Train set: 823 samples
2025-05-11 19:45:08,952 - contrastive_training - INFO - Validation set: 177 samples
2025-05-11 19:45:08,952 - contrastive_training - INFO - Test set: 177 samples
2025-05-11 19:45:08,952 - contrastive_training - INFO - Actual batch sizes - Train: 16, Val: 16, Test: 16
2025-05-11 19:45:08,952 - contrastive_training - INFO - DataLoaders created successfully
2025-05-11 19:45:09,062 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-05-11 19:45:09,063 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-05-11 19:45:09,063 - contrastive_training - INFO - Starting training...
2025-05-11 19:45:09,134 - contrastive_training - INFO - Starting enhanced training on device: cuda
2025-05-11 19:45:10,697 - contrastive_training - ERROR - Error during training: local variable 'hard_negatives_values' referenced before assignment
2025-05-11 19:45:10,697 - contrastive_training - ERROR - Stack trace:
Traceback (most recent call last):
  File "/home/asdf/ig-project/train.py", line 589, in <module>
    trained_model, history = train_contrastive_model(
  File "/home/asdf/ig-project/train.py", line 196, in train_contrastive_model
    loss = loss_fn(image_embeddings, projected_song_embeddings, use_model_temp=True, model_sim=sim_matrix)
  File "/home/asdf/anaconda3/envs/project/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/asdf/anaconda3/envs/project/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/asdf/ig-project/models/decoder/contrastive.py", line 152, in forward
    neg_sim = hard_negatives_values[:, 0]
UnboundLocalError: local variable 'hard_negatives_values' referenced before assignment
