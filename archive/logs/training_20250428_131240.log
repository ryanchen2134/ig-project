2025-04-28 13:12:40,682 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 13:12:40,683 - contrastive_training - INFO - Training parameters:
2025-04-28 13:12:40,683 - contrastive_training - INFO - Backbone architecture: efficientnet_b0
2025-04-28 13:12:40,683 - contrastive_training - INFO - Batch size: 64
2025-04-28 13:12:40,683 - contrastive_training - INFO - Embedding dimension: 256
2025-04-28 13:12:40,683 - contrastive_training - INFO - Learning rate: 0.0003
2025-04-28 13:12:40,683 - contrastive_training - INFO - Weight decay: 0.0001
2025-04-28 13:12:40,684 - contrastive_training - INFO - Max epochs: 300
2025-04-28 13:12:40,684 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 13:12:40,684 - contrastive_training - INFO - NT-Xent temperature: 0.05
2025-04-28 13:12:40,684 - contrastive_training - INFO - Hard negative weight: 0.3
2025-04-28 13:12:40,684 - contrastive_training - INFO - Mixup alpha: 0.4
2025-04-28 13:12:40,712 - contrastive_training - INFO - Using device: cuda
2025-04-28 13:12:40,712 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 13:12:40,712 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 13:12:41,099 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 13:12:41,123 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 13:13:00,830 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 13:13:00,832 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 13:13:00,832 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 13:13:00,832 - contrastive_training - INFO - Actual batch sizes - Train: 64, Val: 64, Test: 64
2025-04-28 13:13:00,832 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 13:13:00,926 - contrastive_training - INFO - Model initialized successfully with efficientnet_b0 backbone
2025-04-28 13:13:00,927 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 13:13:00,927 - contrastive_training - INFO - Starting training...
2025-04-28 13:13:01,075 - contrastive_training - INFO - Starting enhanced training on device: cuda
2025-04-28 13:14:16,189 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.14%, R@10: 4.28%
2025-04-28 13:14:16,189 - contrastive_training - INFO - Current Learning rate: 0.000033
2025-04-28 13:14:16,189 - contrastive_training - INFO - Epoch [1/300], Train Loss: 5.2187, Val Loss: 4.9662, Time: 75.11s
2025-04-28 13:14:16,190 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 13:14:28,243 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 13:15:40,802 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 1.60%, R@10: 4.81%
2025-04-28 13:15:40,802 - contrastive_training - INFO - Current Learning rate: 0.000062
2025-04-28 13:15:40,802 - contrastive_training - INFO - Epoch [2/300], Train Loss: 5.1979, Val Loss: 4.9394, Time: 72.56s
2025-04-28 13:15:40,805 - contrastive_training - INFO - Recall@1 improved to 0.53%
2025-04-28 13:16:52,182 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.14%, R@10: 5.35%
2025-04-28 13:16:52,182 - contrastive_training - INFO - Current Learning rate: 0.000092
2025-04-28 13:16:52,182 - contrastive_training - INFO - Epoch [3/300], Train Loss: 5.1499, Val Loss: 4.9716, Time: 71.38s
2025-04-28 13:16:52,182 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 13:18:03,777 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.21%, R@10: 5.35%
2025-04-28 13:18:03,778 - contrastive_training - INFO - Current Learning rate: 0.000122
2025-04-28 13:18:03,778 - contrastive_training - INFO - Epoch [4/300], Train Loss: 5.0900, Val Loss: 5.0198, Time: 71.60s
2025-04-28 13:18:03,778 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 13:19:13,758 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.28%, R@10: 5.88%
2025-04-28 13:19:13,758 - contrastive_training - INFO - Current Learning rate: 0.000151
2025-04-28 13:19:13,758 - contrastive_training - INFO - Epoch [5/300], Train Loss: 4.9955, Val Loss: 5.0085, Time: 69.98s
2025-04-28 13:19:13,758 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 13:19:16,043 - contrastive_training - INFO - Recall@1 improved to 1.07%
2025-04-28 13:20:28,746 - contrastive_training - INFO - Recalls: R@1: 2.14%, R@5: 4.81%, R@10: 6.95%
2025-04-28 13:20:28,746 - contrastive_training - INFO - Current Learning rate: 0.000181
2025-04-28 13:20:28,746 - contrastive_training - INFO - Epoch [6/300], Train Loss: 5.0278, Val Loss: 4.9422, Time: 72.70s
2025-04-28 13:20:28,749 - contrastive_training - INFO - Recall@1 improved to 2.14%
2025-04-28 13:21:41,005 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 5.88%
2025-04-28 13:21:41,005 - contrastive_training - INFO - Current Learning rate: 0.000211
2025-04-28 13:21:41,005 - contrastive_training - INFO - Epoch [7/300], Train Loss: 4.9825, Val Loss: 4.9007, Time: 72.26s
2025-04-28 13:21:41,005 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 13:22:57,231 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 1.07%, R@10: 5.35%
2025-04-28 13:22:57,231 - contrastive_training - INFO - Current Learning rate: 0.000241
2025-04-28 13:22:57,231 - contrastive_training - INFO - Epoch [8/300], Train Loss: 4.9163, Val Loss: 4.8530, Time: 76.23s
2025-04-28 13:22:57,231 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 13:24:13,679 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 4.28%
2025-04-28 13:24:13,679 - contrastive_training - INFO - Current Learning rate: 0.000270
2025-04-28 13:24:13,680 - contrastive_training - INFO - Epoch [9/300], Train Loss: 4.9547, Val Loss: 4.8748, Time: 76.45s
2025-04-28 13:24:13,680 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 13:25:30,987 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.14%, R@10: 5.88%
2025-04-28 13:25:30,987 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:25:30,987 - contrastive_training - INFO - Epoch [10/300], Train Loss: 4.9403, Val Loss: 4.8804, Time: 77.31s
2025-04-28 13:25:30,988 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 13:25:33,146 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 13:26:50,861 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 1.60%, R@10: 3.74%
2025-04-28 13:26:50,861 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:26:50,861 - contrastive_training - INFO - Epoch [11/300], Train Loss: 4.9367, Val Loss: 4.8776, Time: 77.72s
2025-04-28 13:26:50,861 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 13:28:08,805 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 4.81%
2025-04-28 13:28:08,806 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:28:08,806 - contrastive_training - INFO - Epoch [12/300], Train Loss: 4.9281, Val Loss: 4.8948, Time: 77.95s
2025-04-28 13:28:08,806 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 13:29:26,849 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.67%, R@10: 5.88%
2025-04-28 13:29:26,851 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:29:26,851 - contrastive_training - INFO - Epoch [13/300], Train Loss: 4.9244, Val Loss: 4.9183, Time: 78.04s
2025-04-28 13:29:26,851 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 13:30:44,544 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 3.74%
2025-04-28 13:30:44,545 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:30:44,545 - contrastive_training - INFO - Epoch [14/300], Train Loss: 4.9330, Val Loss: 4.9266, Time: 77.69s
2025-04-28 13:30:44,545 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 13:32:03,439 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.21%, R@10: 5.35%
2025-04-28 13:32:03,440 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:32:03,440 - contrastive_training - INFO - Epoch [15/300], Train Loss: 4.9221, Val Loss: 4.9698, Time: 78.89s
2025-04-28 13:32:03,440 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 13:32:05,543 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 13:33:22,506 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 6.42%
2025-04-28 13:33:22,506 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:33:22,506 - contrastive_training - INFO - Epoch [16/300], Train Loss: 4.9356, Val Loss: 4.9594, Time: 76.96s
2025-04-28 13:33:22,506 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 13:34:39,587 - contrastive_training - INFO - Recalls: R@1: 1.60%, R@5: 3.74%, R@10: 4.28%
2025-04-28 13:34:39,587 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 13:34:39,587 - contrastive_training - INFO - Epoch [17/300], Train Loss: 4.9445, Val Loss: 4.9640, Time: 77.08s
2025-04-28 13:34:39,587 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 13:35:56,248 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.28%, R@10: 5.35%
2025-04-28 13:35:56,249 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 13:35:56,249 - contrastive_training - INFO - Epoch [18/300], Train Loss: 4.9653, Val Loss: 4.9712, Time: 76.66s
2025-04-28 13:35:56,249 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 13:37:12,958 - contrastive_training - INFO - Recalls: R@1: 1.60%, R@5: 2.67%, R@10: 4.81%
2025-04-28 13:37:12,958 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 13:37:12,958 - contrastive_training - INFO - Epoch [19/300], Train Loss: 4.9717, Val Loss: 5.0256, Time: 76.71s
2025-04-28 13:37:12,958 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 13:38:28,754 - contrastive_training - INFO - Recalls: R@1: 1.60%, R@5: 3.21%, R@10: 3.74%
2025-04-28 13:38:28,754 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 13:38:28,754 - contrastive_training - INFO - Epoch [20/300], Train Loss: 4.9824, Val Loss: 5.0201, Time: 75.80s
2025-04-28 13:38:28,754 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 13:38:31,011 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 13:39:46,994 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 3.74%
2025-04-28 13:39:46,994 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 13:39:46,994 - contrastive_training - INFO - Epoch [21/300], Train Loss: 4.9966, Val Loss: 5.0341, Time: 75.98s
2025-04-28 13:39:46,995 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 13:39:46,995 - contrastive_training - INFO - Early stopping triggered after 21 epochs
2025-04-28 13:39:47,062 - contrastive_training - INFO - 
Training Summary:
2025-04-28 13:39:47,062 - contrastive_training - INFO - Total training time: 1605.99 seconds
2025-04-28 13:39:47,062 - contrastive_training - INFO - Best Recall@1: 2.14% (achieved on epoch 6)
2025-04-28 13:39:47,062 - contrastive_training - INFO - Plotting training history...
2025-04-28 13:39:47,321 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 13:44:58,735 - contrastive_training - INFO - Training completed and model saved as contrastive_model_efficientnet_b0.pth!
2025-04-28 13:44:58,736 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 13:45:35,137 - contrastive_training - INFO - Test Loss: 4.2356
2025-04-28 13:46:11,760 - contrastive_training - INFO - Matching accuracy on test set: 2.66%
