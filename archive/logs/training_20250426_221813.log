2025-04-26 22:18:13,514 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-26 22:18:13,514 - contrastive_training - INFO - Training parameters:
2025-04-26 22:18:13,514 - contrastive_training - INFO - Backbone architecture: resnet18
2025-04-26 22:18:13,514 - contrastive_training - INFO - Batch size: 8
2025-04-26 22:18:13,514 - contrastive_training - INFO - Embedding dimension: 64
2025-04-26 22:18:13,514 - contrastive_training - INFO - Learning rate: 0.001
2025-04-26 22:18:13,514 - contrastive_training - INFO - Weight decay: 0.0001
2025-04-26 22:18:13,518 - contrastive_training - INFO - Max epochs: 100
2025-04-26 22:18:13,518 - contrastive_training - INFO - Early stopping patience: 15
2025-04-26 22:18:13,518 - contrastive_training - INFO - NT-Xent temperature: 0.1
2025-04-26 22:18:13,518 - contrastive_training - INFO - Hard negative weight: 0.5
2025-04-26 22:18:13,518 - contrastive_training - INFO - Mixup alpha: 0.2
2025-04-26 22:18:13,542 - contrastive_training - INFO - Using device: cuda
2025-04-26 22:18:13,542 - contrastive_training - INFO - Data path: essentia_audio_encoder/final-sample-dataset/data.csv
2025-04-26 22:18:13,542 - contrastive_training - INFO - Image folder: essentia_audio_encoder/final-sample-dataset/images
2025-04-26 22:18:13,604 - contrastive_training - INFO - Dataset successfully loaded with 459 samples
2025-04-26 22:18:13,625 - contrastive_training - INFO - Song embedding dimension: 72
2025-04-26 22:18:21,136 - contrastive_training - INFO - Train set: 321 samples
2025-04-26 22:18:21,136 - contrastive_training - INFO - Validation set: 69 samples
2025-04-26 22:18:21,138 - contrastive_training - INFO - Test set: 69 samples
2025-04-26 22:18:21,138 - contrastive_training - INFO - Actual batch sizes - Train: 8, Val: 8, Test: 8
2025-04-26 22:18:21,138 - contrastive_training - INFO - DataLoaders created successfully
2025-04-26 22:18:21,253 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-04-26 22:18:21,253 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-26 22:18:21,253 - contrastive_training - INFO - Starting training...
2025-04-26 22:18:21,370 - contrastive_training - INFO - Starting training on device: cuda
2025-04-26 22:18:21,370 - contrastive_training - INFO - Number of training batches: 41
2025-04-26 22:18:21,370 - contrastive_training - INFO - Number of validation batches: 9
2025-04-26 22:19:27,906 - contrastive_training - INFO - Current Learning rate: 0.000010
2025-04-26 22:19:27,906 - contrastive_training - INFO - Epoch [1/100], Train Loss: 2.8528, Val Loss: 2.1807, Time: 66.54s
2025-04-26 22:19:27,906 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-26 22:20:10,912 - contrastive_training - INFO - Validation loss improved to 2.1807
2025-04-26 22:21:16,467 - contrastive_training - INFO - Current Learning rate: 0.000208
2025-04-26 22:21:16,467 - contrastive_training - INFO - Epoch [2/100], Train Loss: 2.1654, Val Loss: 1.8773, Time: 65.55s
2025-04-26 22:21:16,468 - contrastive_training - INFO - Validation loss improved to 1.8773
2025-04-26 22:22:22,234 - contrastive_training - INFO - Current Learning rate: 0.000406
2025-04-26 22:22:22,234 - contrastive_training - INFO - Epoch [3/100], Train Loss: 1.9493, Val Loss: 1.8534, Time: 65.77s
2025-04-26 22:22:22,235 - contrastive_training - INFO - Validation loss improved to 1.8534
2025-04-26 22:23:27,619 - contrastive_training - INFO - Current Learning rate: 0.000604
2025-04-26 22:23:27,619 - contrastive_training - INFO - Epoch [4/100], Train Loss: 1.9135, Val Loss: 1.8733, Time: 65.38s
2025-04-26 22:23:27,619 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-26 22:24:33,198 - contrastive_training - INFO - Current Learning rate: 0.000802
2025-04-26 22:24:33,199 - contrastive_training - INFO - Epoch [5/100], Train Loss: 1.8972, Val Loss: 1.8607, Time: 65.58s
2025-04-26 22:24:33,341 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_5.pth
2025-04-26 22:24:33,342 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-26 22:25:07,173 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-26 22:26:12,790 - contrastive_training - INFO - Current Learning rate: 0.001000
2025-04-26 22:26:12,791 - contrastive_training - INFO - Epoch [6/100], Train Loss: 1.8803, Val Loss: 1.8348, Time: 65.62s
2025-04-26 22:26:12,791 - contrastive_training - INFO - Validation loss improved to 1.8348
2025-04-26 22:27:18,164 - contrastive_training - INFO - Current Learning rate: 0.001000
2025-04-26 22:27:18,164 - contrastive_training - INFO - Epoch [7/100], Train Loss: 1.8787, Val Loss: 1.8669, Time: 65.37s
2025-04-26 22:27:18,164 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-26 22:28:23,548 - contrastive_training - INFO - Current Learning rate: 0.000999
2025-04-26 22:28:23,548 - contrastive_training - INFO - Epoch [8/100], Train Loss: 1.8776, Val Loss: 1.8444, Time: 65.38s
2025-04-26 22:28:23,549 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-26 22:29:30,114 - contrastive_training - INFO - Current Learning rate: 0.000998
2025-04-26 22:29:30,114 - contrastive_training - INFO - Epoch [9/100], Train Loss: 1.8661, Val Loss: 1.8739, Time: 66.56s
2025-04-26 22:29:30,114 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-26 22:30:35,679 - contrastive_training - INFO - Current Learning rate: 0.000996
2025-04-26 22:30:35,679 - contrastive_training - INFO - Epoch [10/100], Train Loss: 1.8779, Val Loss: 1.8478, Time: 65.57s
2025-04-26 22:30:35,814 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_10.pth
2025-04-26 22:30:35,814 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-26 22:31:09,565 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-26 22:32:15,221 - contrastive_training - INFO - Current Learning rate: 0.000993
2025-04-26 22:32:15,221 - contrastive_training - INFO - Epoch [11/100], Train Loss: 1.8506, Val Loss: 1.8565, Time: 65.66s
2025-04-26 22:32:15,221 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-26 22:33:21,029 - contrastive_training - INFO - Current Learning rate: 0.000990
2025-04-26 22:33:21,029 - contrastive_training - INFO - Epoch [12/100], Train Loss: 1.8741, Val Loss: 1.8615, Time: 65.81s
2025-04-26 22:33:21,029 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-26 22:34:27,023 - contrastive_training - INFO - Current Learning rate: 0.000987
2025-04-26 22:34:27,023 - contrastive_training - INFO - Epoch [13/100], Train Loss: 1.8592, Val Loss: 1.8474, Time: 65.99s
2025-04-26 22:34:27,023 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-26 22:35:32,602 - contrastive_training - INFO - Current Learning rate: 0.000983
2025-04-26 22:35:32,602 - contrastive_training - INFO - Epoch [14/100], Train Loss: 1.8593, Val Loss: 1.8662, Time: 65.58s
2025-04-26 22:35:32,603 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-26 22:36:38,139 - contrastive_training - INFO - Current Learning rate: 0.000978
2025-04-26 22:36:38,139 - contrastive_training - INFO - Epoch [15/100], Train Loss: 1.8587, Val Loss: 1.8616, Time: 65.54s
2025-04-26 22:36:38,274 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_15.pth
2025-04-26 22:36:38,274 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-26 22:37:11,909 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-26 22:38:17,548 - contrastive_training - INFO - Current Learning rate: 0.000973
2025-04-26 22:38:17,549 - contrastive_training - INFO - Epoch [16/100], Train Loss: 1.8658, Val Loss: 1.8727, Time: 65.64s
2025-04-26 22:38:17,549 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-26 22:39:23,309 - contrastive_training - INFO - Current Learning rate: 0.000968
2025-04-26 22:39:23,310 - contrastive_training - INFO - Epoch [17/100], Train Loss: 1.8525, Val Loss: 1.8444, Time: 65.76s
2025-04-26 22:39:23,310 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-26 22:40:28,738 - contrastive_training - INFO - Current Learning rate: 0.000962
2025-04-26 22:40:28,739 - contrastive_training - INFO - Epoch [18/100], Train Loss: 1.8651, Val Loss: 1.8360, Time: 65.43s
2025-04-26 22:40:28,739 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-26 22:41:34,251 - contrastive_training - INFO - Current Learning rate: 0.000955
2025-04-26 22:41:34,253 - contrastive_training - INFO - Epoch [19/100], Train Loss: 1.8413, Val Loss: 1.8738, Time: 65.51s
2025-04-26 22:41:34,253 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-26 22:42:40,329 - contrastive_training - INFO - Current Learning rate: 0.000948
2025-04-26 22:42:40,330 - contrastive_training - INFO - Epoch [20/100], Train Loss: 1.8351, Val Loss: 1.8551, Time: 66.08s
2025-04-26 22:42:40,467 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_20.pth
2025-04-26 22:42:40,467 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-26 22:43:14,160 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-26 22:44:20,209 - contrastive_training - INFO - Current Learning rate: 0.000940
2025-04-26 22:44:20,209 - contrastive_training - INFO - Epoch [21/100], Train Loss: 1.8432, Val Loss: 1.8713, Time: 66.05s
2025-04-26 22:44:20,209 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-26 22:44:20,209 - contrastive_training - INFO - Early stopping triggered after 21 epochs
2025-04-26 22:44:20,262 - contrastive_training - INFO - Best model saved to checkpoints\best_model.pth
2025-04-26 22:44:20,262 - contrastive_training - INFO - 
Training Summary:
2025-04-26 22:44:20,262 - contrastive_training - INFO - Total training time: 1558.89 seconds
2025-04-26 22:44:20,262 - contrastive_training - INFO - Best validation loss: 1.8348 (achieved on epoch 6)
2025-04-26 22:44:20,262 - contrastive_training - INFO - Plotting training history...
2025-04-26 22:44:20,615 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-26 22:59:26,484 - contrastive_training - INFO - Training completed and model saved as contrastive_model_resnet18.pth!
2025-04-26 22:59:26,485 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-26 23:00:00,777 - contrastive_training - INFO - Test Loss: 1.8628
2025-04-26 23:00:34,268 - contrastive_training - INFO - Matching accuracy on test set: 8.70%
