2025-04-28 00:30:19,640 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 00:30:19,640 - contrastive_training - INFO - Training parameters:
2025-04-28 00:30:19,640 - contrastive_training - INFO - Backbone architecture: resnet18
2025-04-28 00:30:19,640 - contrastive_training - INFO - Batch size: 64
2025-04-28 00:30:19,640 - contrastive_training - INFO - Embedding dimension: 128
2025-04-28 00:30:19,641 - contrastive_training - INFO - Learning rate: 0.001
2025-04-28 00:30:19,641 - contrastive_training - INFO - Weight decay: 0.0001
2025-04-28 00:30:19,641 - contrastive_training - INFO - Max epochs: 200
2025-04-28 00:30:19,642 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 00:30:19,642 - contrastive_training - INFO - NT-Xent temperature: 0.5
2025-04-28 00:30:19,642 - contrastive_training - INFO - Hard negative weight: 0.2
2025-04-28 00:30:19,642 - contrastive_training - INFO - Mixup alpha: 0.0
2025-04-28 00:30:19,665 - contrastive_training - INFO - Using device: cuda
2025-04-28 00:30:19,665 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 00:30:19,665 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 00:30:20,035 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 00:30:20,058 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 00:30:40,169 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 00:30:40,169 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 00:30:40,169 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 00:30:40,170 - contrastive_training - INFO - Actual batch sizes - Train: 64, Val: 64, Test: 64
2025-04-28 00:30:40,170 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 00:30:40,287 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-04-28 00:30:40,287 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 00:30:40,287 - contrastive_training - INFO - Starting training...
2025-04-28 00:30:40,439 - contrastive_training - INFO - Starting training on device: cuda
2025-04-28 00:30:40,440 - contrastive_training - INFO - Number of training batches: 14
2025-04-28 00:30:40,440 - contrastive_training - INFO - Number of validation batches: 3
2025-04-28 00:31:47,156 - contrastive_training - INFO - Current Learning rate: 0.000010
2025-04-28 00:31:47,156 - contrastive_training - INFO - Epoch [1/200], Train Loss: 4.1413, Val Loss: 4.1396, Time: 66.72s
2025-04-28 00:31:47,156 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 00:32:31,084 - contrastive_training - INFO - Validation loss improved to 4.1396
2025-04-28 00:33:35,634 - contrastive_training - INFO - Current Learning rate: 0.000208
2025-04-28 00:33:35,634 - contrastive_training - INFO - Epoch [2/200], Train Loss: 4.1062, Val Loss: 4.1391, Time: 64.55s
2025-04-28 00:33:35,635 - contrastive_training - INFO - Validation loss improved to 4.1391
2025-04-28 00:34:40,210 - contrastive_training - INFO - Current Learning rate: 0.000406
2025-04-28 00:34:40,210 - contrastive_training - INFO - Epoch [3/200], Train Loss: 4.0400, Val Loss: 4.1574, Time: 64.57s
2025-04-28 00:34:40,210 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 00:35:44,545 - contrastive_training - INFO - Current Learning rate: 0.000604
2025-04-28 00:35:44,545 - contrastive_training - INFO - Epoch [4/200], Train Loss: 3.9433, Val Loss: 4.1930, Time: 64.33s
2025-04-28 00:35:44,546 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 00:36:49,138 - contrastive_training - INFO - Current Learning rate: 0.000802
2025-04-28 00:36:49,138 - contrastive_training - INFO - Epoch [5/200], Train Loss: 3.8061, Val Loss: 4.3269, Time: 64.59s
2025-04-28 00:36:49,267 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_5.pth
2025-04-28 00:36:49,267 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 00:37:23,897 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 00:38:28,916 - contrastive_training - INFO - Current Learning rate: 0.001000
2025-04-28 00:38:28,916 - contrastive_training - INFO - Epoch [6/200], Train Loss: 3.6476, Val Loss: 4.2958, Time: 65.02s
2025-04-28 00:38:28,916 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 00:39:33,489 - contrastive_training - INFO - Current Learning rate: 0.001000
2025-04-28 00:39:33,489 - contrastive_training - INFO - Epoch [7/200], Train Loss: 3.5258, Val Loss: 4.3083, Time: 64.57s
2025-04-28 00:39:33,489 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 00:40:38,095 - contrastive_training - INFO - Current Learning rate: 0.001000
2025-04-28 00:40:38,095 - contrastive_training - INFO - Epoch [8/200], Train Loss: 3.4309, Val Loss: 4.4367, Time: 64.61s
2025-04-28 00:40:38,095 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 00:41:42,661 - contrastive_training - INFO - Current Learning rate: 0.000999
2025-04-28 00:41:42,661 - contrastive_training - INFO - Epoch [9/200], Train Loss: 3.3123, Val Loss: 4.5701, Time: 64.57s
2025-04-28 00:41:42,661 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 00:42:47,049 - contrastive_training - INFO - Current Learning rate: 0.000999
2025-04-28 00:42:47,049 - contrastive_training - INFO - Epoch [10/200], Train Loss: 3.2329, Val Loss: 4.4345, Time: 64.39s
2025-04-28 00:42:47,175 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_10.pth
2025-04-28 00:42:47,175 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 00:43:20,751 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 00:44:25,788 - contrastive_training - INFO - Current Learning rate: 0.000998
2025-04-28 00:44:25,788 - contrastive_training - INFO - Epoch [11/200], Train Loss: 3.1826, Val Loss: 4.4481, Time: 65.04s
2025-04-28 00:44:25,788 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 00:45:30,200 - contrastive_training - INFO - Current Learning rate: 0.000998
2025-04-28 00:45:30,200 - contrastive_training - INFO - Epoch [12/200], Train Loss: 3.1397, Val Loss: 4.4839, Time: 64.41s
2025-04-28 00:45:30,200 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 00:46:34,565 - contrastive_training - INFO - Current Learning rate: 0.000997
2025-04-28 00:46:34,565 - contrastive_training - INFO - Epoch [13/200], Train Loss: 3.1010, Val Loss: 4.4228, Time: 64.36s
2025-04-28 00:46:34,565 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 00:47:39,199 - contrastive_training - INFO - Current Learning rate: 0.000996
2025-04-28 00:47:39,200 - contrastive_training - INFO - Epoch [14/200], Train Loss: 3.0460, Val Loss: 4.4463, Time: 64.63s
2025-04-28 00:47:39,200 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 00:48:43,719 - contrastive_training - INFO - Current Learning rate: 0.000995
2025-04-28 00:48:43,721 - contrastive_training - INFO - Epoch [15/200], Train Loss: 2.9861, Val Loss: 4.4516, Time: 64.52s
2025-04-28 00:48:43,838 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_15.pth
2025-04-28 00:48:43,838 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 00:49:17,433 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 00:50:21,700 - contrastive_training - INFO - Current Learning rate: 0.000994
2025-04-28 00:50:21,700 - contrastive_training - INFO - Epoch [16/200], Train Loss: 2.9387, Val Loss: 4.4684, Time: 64.27s
2025-04-28 00:50:21,701 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 00:51:26,256 - contrastive_training - INFO - Current Learning rate: 0.000992
2025-04-28 00:51:26,257 - contrastive_training - INFO - Epoch [17/200], Train Loss: 2.9184, Val Loss: 4.4141, Time: 64.56s
2025-04-28 00:51:26,257 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 00:51:26,257 - contrastive_training - INFO - Early stopping triggered after 17 epochs
2025-04-28 00:51:26,304 - contrastive_training - INFO - Best model saved to checkpoints\best_model.pth
2025-04-28 00:51:26,304 - contrastive_training - INFO - 
Training Summary:
2025-04-28 00:51:26,304 - contrastive_training - INFO - Total training time: 1245.86 seconds
2025-04-28 00:51:26,304 - contrastive_training - INFO - Best validation loss: 4.1391 (achieved on epoch 2)
2025-04-28 00:51:26,304 - contrastive_training - INFO - Plotting training history...
2025-04-28 00:51:26,521 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 00:55:26,823 - contrastive_training - INFO - Training completed and model saved as contrastive_model_resnet18.pth!
2025-04-28 00:55:26,823 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 00:56:00,025 - contrastive_training - INFO - Test Loss: 4.4232
2025-04-28 00:56:33,258 - contrastive_training - INFO - Matching accuracy on test set: 1.06%
