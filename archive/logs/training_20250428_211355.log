2025-04-28 21:13:55,329 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 21:13:55,329 - contrastive_training - INFO - Training parameters:
2025-04-28 21:13:55,329 - contrastive_training - INFO - Backbone architecture: resnet18
2025-04-28 21:13:55,329 - contrastive_training - INFO - Batch size: 12
2025-04-28 21:13:55,329 - contrastive_training - INFO - Embedding dimension: 128
2025-04-28 21:13:55,329 - contrastive_training - INFO - Learning rate: 0.0003
2025-04-28 21:13:55,329 - contrastive_training - INFO - Weight decay: 0.0001
2025-04-28 21:13:55,329 - contrastive_training - INFO - Max epochs: 300
2025-04-28 21:13:55,329 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 21:13:55,329 - contrastive_training - INFO - NT-Xent temperature: 0.05
2025-04-28 21:13:55,329 - contrastive_training - INFO - Hard negative weight: 0.2
2025-04-28 21:13:55,329 - contrastive_training - INFO - Mixup alpha: 0.4
2025-04-28 21:13:55,342 - contrastive_training - INFO - Using device: cuda
2025-04-28 21:13:55,342 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 21:13:55,342 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 21:13:55,594 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 21:13:55,613 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 21:14:12,047 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 21:14:12,048 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 21:14:12,048 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 21:14:12,048 - contrastive_training - INFO - Actual batch sizes - Train: 12, Val: 12, Test: 12
2025-04-28 21:14:12,048 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 21:14:12,161 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-04-28 21:14:12,162 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 21:14:12,162 - contrastive_training - INFO - Starting training...
2025-04-28 21:14:12,237 - contrastive_training - INFO - Starting enhanced training on device: cuda
2025-04-28 21:14:15,041 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 4.81%
2025-04-28 21:14:15,041 - contrastive_training - INFO - Current Learning rate: 0.000033
2025-04-28 21:14:15,041 - contrastive_training - INFO - Epoch [1/300], Train Loss: 3.7463, Val Loss: 3.5704, Time: 2.80s
2025-04-28 21:14:15,041 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 21:14:22,619 - contrastive_training - INFO - Recall@1 improved to 0.53%
2025-04-28 21:14:25,004 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.21%, R@10: 6.42%
2025-04-28 21:14:25,004 - contrastive_training - INFO - Current Learning rate: 0.000062
2025-04-28 21:14:25,005 - contrastive_training - INFO - Epoch [2/300], Train Loss: 3.8023, Val Loss: 3.5308, Time: 2.39s
2025-04-28 21:14:25,005 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 21:14:27,399 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.21%, R@10: 7.49%
2025-04-28 21:14:27,399 - contrastive_training - INFO - Current Learning rate: 0.000092
2025-04-28 21:14:27,399 - contrastive_training - INFO - Epoch [3/300], Train Loss: 3.6681, Val Loss: 3.4923, Time: 2.39s
2025-04-28 21:14:27,399 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 21:14:29,766 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 5.35%
2025-04-28 21:14:29,767 - contrastive_training - INFO - Current Learning rate: 0.000122
2025-04-28 21:14:29,767 - contrastive_training - INFO - Epoch [4/300], Train Loss: 3.6826, Val Loss: 3.4532, Time: 2.37s
2025-04-28 21:14:29,768 - contrastive_training - INFO - Recall@1 improved to 1.07%
2025-04-28 21:14:32,182 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 6.95%
2025-04-28 21:14:32,182 - contrastive_training - INFO - Current Learning rate: 0.000151
2025-04-28 21:14:32,182 - contrastive_training - INFO - Epoch [5/300], Train Loss: 3.6011, Val Loss: 3.4072, Time: 2.41s
2025-04-28 21:14:32,182 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 21:14:34,104 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 21:14:36,511 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.81%, R@10: 8.56%
2025-04-28 21:14:36,511 - contrastive_training - INFO - Current Learning rate: 0.000181
2025-04-28 21:14:36,511 - contrastive_training - INFO - Epoch [6/300], Train Loss: 3.5780, Val Loss: 3.4519, Time: 2.41s
2025-04-28 21:14:36,511 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 21:14:38,925 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 6.95%
2025-04-28 21:14:38,925 - contrastive_training - INFO - Current Learning rate: 0.000211
2025-04-28 21:14:38,925 - contrastive_training - INFO - Epoch [7/300], Train Loss: 3.5441, Val Loss: 3.4980, Time: 2.41s
2025-04-28 21:14:38,925 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 21:14:41,320 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 6.95%
2025-04-28 21:14:41,320 - contrastive_training - INFO - Current Learning rate: 0.000241
2025-04-28 21:14:41,320 - contrastive_training - INFO - Epoch [8/300], Train Loss: 3.5634, Val Loss: 3.5380, Time: 2.40s
2025-04-28 21:14:41,320 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 21:14:43,713 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.74%, R@10: 6.95%
2025-04-28 21:14:43,713 - contrastive_training - INFO - Current Learning rate: 0.000270
2025-04-28 21:14:43,713 - contrastive_training - INFO - Epoch [9/300], Train Loss: 3.6105, Val Loss: 3.5824, Time: 2.39s
2025-04-28 21:14:43,713 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 21:14:46,147 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 6.42%
2025-04-28 21:14:46,147 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:14:46,148 - contrastive_training - INFO - Epoch [10/300], Train Loss: 3.6561, Val Loss: 3.6648, Time: 2.43s
2025-04-28 21:14:46,148 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 21:14:48,048 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 21:14:50,468 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 4.28%, R@10: 8.02%
2025-04-28 21:14:50,469 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:14:50,469 - contrastive_training - INFO - Epoch [11/300], Train Loss: 3.7075, Val Loss: 3.7441, Time: 2.42s
2025-04-28 21:14:50,469 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 21:14:52,866 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 6.95%
2025-04-28 21:14:52,866 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:14:52,866 - contrastive_training - INFO - Epoch [12/300], Train Loss: 3.7604, Val Loss: 3.8276, Time: 2.40s
2025-04-28 21:14:52,866 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 21:14:55,281 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.21%, R@10: 5.88%
2025-04-28 21:14:55,281 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:14:55,281 - contrastive_training - INFO - Epoch [13/300], Train Loss: 3.8322, Val Loss: 3.8668, Time: 2.42s
2025-04-28 21:14:55,281 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 21:14:57,692 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 6.42%
2025-04-28 21:14:57,692 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:14:57,692 - contrastive_training - INFO - Epoch [14/300], Train Loss: 3.8889, Val Loss: 3.9662, Time: 2.41s
2025-04-28 21:14:57,692 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 21:15:00,099 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 5.35%
2025-04-28 21:15:00,099 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:15:00,099 - contrastive_training - INFO - Epoch [15/300], Train Loss: 3.9641, Val Loss: 4.1018, Time: 2.41s
2025-04-28 21:15:00,099 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 21:15:02,068 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 21:15:04,506 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.81%, R@10: 6.95%
2025-04-28 21:15:04,506 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:15:04,506 - contrastive_training - INFO - Epoch [16/300], Train Loss: 4.0329, Val Loss: 4.1597, Time: 2.44s
2025-04-28 21:15:04,506 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 21:15:06,935 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 4.28%
2025-04-28 21:15:06,936 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:15:06,936 - contrastive_training - INFO - Epoch [17/300], Train Loss: 4.0978, Val Loss: 4.2336, Time: 2.43s
2025-04-28 21:15:06,936 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 21:15:09,361 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 8.02%
2025-04-28 21:15:09,361 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 21:15:09,361 - contrastive_training - INFO - Epoch [18/300], Train Loss: 4.1833, Val Loss: 4.3392, Time: 2.43s
2025-04-28 21:15:09,361 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 21:15:11,841 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 1.07%, R@10: 5.35%
2025-04-28 21:15:11,841 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 21:15:11,841 - contrastive_training - INFO - Epoch [19/300], Train Loss: 4.2884, Val Loss: 4.4424, Time: 2.48s
2025-04-28 21:15:11,841 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 21:15:11,841 - contrastive_training - INFO - Early stopping triggered after 19 epochs
2025-04-28 21:15:11,902 - contrastive_training - INFO - 
Training Summary:
2025-04-28 21:15:11,902 - contrastive_training - INFO - Total training time: 59.67 seconds
2025-04-28 21:15:11,902 - contrastive_training - INFO - Best Recall@1: 1.07% (achieved on epoch 4)
2025-04-28 21:15:11,902 - contrastive_training - INFO - Plotting training history...
2025-04-28 21:15:12,297 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 21:15:16,101 - contrastive_training - INFO - Training completed and model saved as contrastive_model_resnet18.pth!
2025-04-28 21:15:16,102 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 21:15:16,503 - contrastive_training - INFO - Test Loss: 2.5771
2025-04-28 21:15:16,504 - contrastive_training - INFO - Top-5 matching accuracy on test set: 47.87%
