2025-04-28 20:59:12,781 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 20:59:12,781 - contrastive_training - INFO - Training parameters:
2025-04-28 20:59:12,781 - contrastive_training - INFO - Backbone architecture: efficientnet_b0
2025-04-28 20:59:12,781 - contrastive_training - INFO - Batch size: 16
2025-04-28 20:59:12,781 - contrastive_training - INFO - Embedding dimension: 128
2025-04-28 20:59:12,781 - contrastive_training - INFO - Learning rate: 0.0003
2025-04-28 20:59:12,781 - contrastive_training - INFO - Weight decay: 0.0001
2025-04-28 20:59:12,781 - contrastive_training - INFO - Max epochs: 300
2025-04-28 20:59:12,781 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 20:59:12,781 - contrastive_training - INFO - NT-Xent temperature: 0.05
2025-04-28 20:59:12,781 - contrastive_training - INFO - Hard negative weight: 0.2
2025-04-28 20:59:12,781 - contrastive_training - INFO - Mixup alpha: 0.4
2025-04-28 20:59:12,794 - contrastive_training - INFO - Using device: cuda
2025-04-28 20:59:12,794 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 20:59:12,794 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 20:59:13,044 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 20:59:13,064 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 20:59:29,499 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 20:59:29,499 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 20:59:29,499 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 20:59:29,499 - contrastive_training - INFO - Actual batch sizes - Train: 16, Val: 16, Test: 16
2025-04-28 20:59:29,499 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 20:59:29,566 - contrastive_training - INFO - Model initialized successfully with efficientnet_b0 backbone
2025-04-28 20:59:29,567 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 20:59:29,567 - contrastive_training - INFO - Starting training...
2025-04-28 20:59:29,665 - contrastive_training - INFO - Starting enhanced training on device: cuda
2025-04-28 20:59:32,934 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 1.07%, R@10: 4.28%
2025-04-28 20:59:32,934 - contrastive_training - INFO - Current Learning rate: 0.000033
2025-04-28 20:59:32,934 - contrastive_training - INFO - Epoch [1/300], Train Loss: 4.2135, Val Loss: 4.1405, Time: 3.27s
2025-04-28 20:59:32,934 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:59:40,482 - contrastive_training - INFO - Recall@1 improved to 0.53%
2025-04-28 20:59:43,240 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 1.60%, R@10: 2.67%
2025-04-28 20:59:43,241 - contrastive_training - INFO - Current Learning rate: 0.000062
2025-04-28 20:59:43,241 - contrastive_training - INFO - Epoch [2/300], Train Loss: 4.1675, Val Loss: 4.1525, Time: 2.76s
2025-04-28 20:59:43,241 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:59:45,986 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.14%, R@10: 5.88%
2025-04-28 20:59:45,986 - contrastive_training - INFO - Current Learning rate: 0.000092
2025-04-28 20:59:45,986 - contrastive_training - INFO - Epoch [3/300], Train Loss: 4.1287, Val Loss: 4.0152, Time: 2.75s
2025-04-28 20:59:45,986 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 20:59:48,741 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 4.81%, R@10: 7.49%
2025-04-28 20:59:48,742 - contrastive_training - INFO - Current Learning rate: 0.000122
2025-04-28 20:59:48,742 - contrastive_training - INFO - Epoch [4/300], Train Loss: 3.9962, Val Loss: 3.7414, Time: 2.76s
2025-04-28 20:59:48,742 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 20:59:51,489 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.21%, R@10: 6.42%
2025-04-28 20:59:51,489 - contrastive_training - INFO - Current Learning rate: 0.000151
2025-04-28 20:59:51,489 - contrastive_training - INFO - Epoch [5/300], Train Loss: 3.8502, Val Loss: 3.6101, Time: 2.75s
2025-04-28 20:59:51,489 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:59:53,240 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 20:59:56,063 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 5.35%, R@10: 6.95%
2025-04-28 20:59:56,063 - contrastive_training - INFO - Current Learning rate: 0.000181
2025-04-28 20:59:56,063 - contrastive_training - INFO - Epoch [6/300], Train Loss: 3.7403, Val Loss: 3.5467, Time: 2.82s
2025-04-28 20:59:56,065 - contrastive_training - INFO - Recall@1 improved to 1.07%
2025-04-28 20:59:59,145 - contrastive_training - INFO - Recalls: R@1: 1.60%, R@5: 3.74%, R@10: 8.56%
2025-04-28 20:59:59,145 - contrastive_training - INFO - Current Learning rate: 0.000211
2025-04-28 20:59:59,145 - contrastive_training - INFO - Epoch [7/300], Train Loss: 3.6965, Val Loss: 3.5745, Time: 3.08s
2025-04-28 20:59:59,147 - contrastive_training - INFO - Recall@1 improved to 1.60%
2025-04-28 21:00:02,257 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 6.42%
2025-04-28 21:00:02,257 - contrastive_training - INFO - Current Learning rate: 0.000241
2025-04-28 21:00:02,257 - contrastive_training - INFO - Epoch [8/300], Train Loss: 3.6711, Val Loss: 3.6054, Time: 3.11s
2025-04-28 21:00:02,257 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 21:00:05,179 - contrastive_training - INFO - Recalls: R@1: 1.60%, R@5: 2.67%, R@10: 8.56%
2025-04-28 21:00:05,179 - contrastive_training - INFO - Current Learning rate: 0.000270
2025-04-28 21:00:05,179 - contrastive_training - INFO - Epoch [9/300], Train Loss: 3.6892, Val Loss: 3.6338, Time: 2.92s
2025-04-28 21:00:05,179 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 21:00:08,276 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.74%, R@10: 5.88%
2025-04-28 21:00:08,276 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:08,276 - contrastive_training - INFO - Epoch [10/300], Train Loss: 3.7143, Val Loss: 3.6810, Time: 3.10s
2025-04-28 21:00:08,276 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 21:00:10,246 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 21:00:13,117 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 1.60%, R@10: 4.28%
2025-04-28 21:00:13,117 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:13,117 - contrastive_training - INFO - Epoch [11/300], Train Loss: 3.7526, Val Loss: 3.7159, Time: 2.87s
2025-04-28 21:00:13,117 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 21:00:15,932 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.67%, R@10: 5.35%
2025-04-28 21:00:15,933 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:15,933 - contrastive_training - INFO - Epoch [12/300], Train Loss: 3.7690, Val Loss: 3.7541, Time: 2.82s
2025-04-28 21:00:15,933 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 21:00:18,840 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 5.35%
2025-04-28 21:00:18,840 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:18,841 - contrastive_training - INFO - Epoch [13/300], Train Loss: 3.8120, Val Loss: 3.7931, Time: 2.91s
2025-04-28 21:00:18,841 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 21:00:21,824 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 5.88%
2025-04-28 21:00:21,824 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:21,824 - contrastive_training - INFO - Epoch [14/300], Train Loss: 3.8405, Val Loss: 3.8314, Time: 2.98s
2025-04-28 21:00:21,824 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 21:00:24,627 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 6.42%
2025-04-28 21:00:24,627 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:24,627 - contrastive_training - INFO - Epoch [15/300], Train Loss: 3.8697, Val Loss: 3.8686, Time: 2.80s
2025-04-28 21:00:24,627 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 21:00:26,443 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 21:00:29,259 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.74%, R@10: 5.88%
2025-04-28 21:00:29,259 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:29,259 - contrastive_training - INFO - Epoch [16/300], Train Loss: 3.9122, Val Loss: 3.9295, Time: 2.82s
2025-04-28 21:00:29,260 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 21:00:32,078 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 7.49%
2025-04-28 21:00:32,078 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 21:00:32,078 - contrastive_training - INFO - Epoch [17/300], Train Loss: 3.9588, Val Loss: 3.9907, Time: 2.82s
2025-04-28 21:00:32,078 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 21:00:34,875 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.74%, R@10: 9.63%
2025-04-28 21:00:34,875 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 21:00:34,875 - contrastive_training - INFO - Epoch [18/300], Train Loss: 3.9907, Val Loss: 3.9950, Time: 2.80s
2025-04-28 21:00:34,875 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 21:00:37,876 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 7.49%
2025-04-28 21:00:37,876 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 21:00:37,876 - contrastive_training - INFO - Epoch [19/300], Train Loss: 4.0340, Val Loss: 4.0421, Time: 3.00s
2025-04-28 21:00:37,876 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 21:00:40,733 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 8.02%
2025-04-28 21:00:40,734 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 21:00:40,734 - contrastive_training - INFO - Epoch [20/300], Train Loss: 4.0623, Val Loss: 4.0972, Time: 2.86s
2025-04-28 21:00:40,734 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 21:00:42,804 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 21:00:45,835 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 4.28%, R@10: 8.02%
2025-04-28 21:00:45,835 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 21:00:45,835 - contrastive_training - INFO - Epoch [21/300], Train Loss: 4.1004, Val Loss: 4.1207, Time: 3.03s
2025-04-28 21:00:45,835 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 21:00:48,784 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.28%, R@10: 8.02%
2025-04-28 21:00:48,784 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 21:00:48,784 - contrastive_training - INFO - Epoch [22/300], Train Loss: 4.1304, Val Loss: 4.2216, Time: 2.95s
2025-04-28 21:00:48,784 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 21:00:48,784 - contrastive_training - INFO - Early stopping triggered after 22 epochs
2025-04-28 21:00:48,835 - contrastive_training - INFO - 
Training Summary:
2025-04-28 21:00:48,835 - contrastive_training - INFO - Total training time: 79.17 seconds
2025-04-28 21:00:48,835 - contrastive_training - INFO - Best Recall@1: 1.60% (achieved on epoch 7)
2025-04-28 21:00:48,836 - contrastive_training - INFO - Plotting training history...
2025-04-28 21:00:49,024 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 21:00:52,354 - contrastive_training - INFO - Training completed and model saved as contrastive_model_efficientnet_b0.pth!
2025-04-28 21:00:52,354 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 21:00:52,782 - contrastive_training - INFO - Test Loss: 2.8592
2025-04-28 21:00:52,782 - contrastive_training - INFO - Top-5 matching accuracy on test set: 36.17%
