2025-04-28 20:55:59,783 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 20:55:59,783 - contrastive_training - INFO - Training parameters:
2025-04-28 20:55:59,783 - contrastive_training - INFO - Backbone architecture: resnet18
2025-04-28 20:55:59,783 - contrastive_training - INFO - Batch size: 16
2025-04-28 20:55:59,783 - contrastive_training - INFO - Embedding dimension: 128
2025-04-28 20:55:59,783 - contrastive_training - INFO - Learning rate: 0.0003
2025-04-28 20:55:59,783 - contrastive_training - INFO - Weight decay: 0.0001
2025-04-28 20:55:59,783 - contrastive_training - INFO - Max epochs: 300
2025-04-28 20:55:59,783 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 20:55:59,783 - contrastive_training - INFO - NT-Xent temperature: 0.05
2025-04-28 20:55:59,783 - contrastive_training - INFO - Hard negative weight: 0.2
2025-04-28 20:55:59,783 - contrastive_training - INFO - Mixup alpha: 0.4
2025-04-28 20:55:59,796 - contrastive_training - INFO - Using device: cuda
2025-04-28 20:55:59,796 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 20:55:59,796 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 20:56:00,047 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 20:56:00,067 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 20:56:16,520 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 20:56:16,520 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 20:56:16,520 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 20:56:16,520 - contrastive_training - INFO - Actual batch sizes - Train: 16, Val: 16, Test: 16
2025-04-28 20:56:16,520 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 20:56:16,632 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-04-28 20:56:16,632 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 20:56:16,632 - contrastive_training - INFO - Starting training...
2025-04-28 20:56:16,713 - contrastive_training - INFO - Starting enhanced training on device: cuda
2025-04-28 20:56:19,311 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 1.60%, R@10: 3.74%
2025-04-28 20:56:19,312 - contrastive_training - INFO - Current Learning rate: 0.000033
2025-04-28 20:56:19,312 - contrastive_training - INFO - Epoch [1/300], Train Loss: 4.1629, Val Loss: 3.9151, Time: 2.60s
2025-04-28 20:56:19,312 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:56:26,851 - contrastive_training - INFO - Recall@1 improved to 0.53%
2025-04-28 20:56:29,040 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.14%, R@10: 5.35%
2025-04-28 20:56:29,041 - contrastive_training - INFO - Current Learning rate: 0.000062
2025-04-28 20:56:29,041 - contrastive_training - INFO - Epoch [2/300], Train Loss: 4.1522, Val Loss: 3.8722, Time: 2.19s
2025-04-28 20:56:29,041 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:56:31,155 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.21%, R@10: 5.88%
2025-04-28 20:56:31,155 - contrastive_training - INFO - Current Learning rate: 0.000092
2025-04-28 20:56:31,155 - contrastive_training - INFO - Epoch [3/300], Train Loss: 3.9715, Val Loss: 3.7932, Time: 2.11s
2025-04-28 20:56:31,155 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 20:56:33,283 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 8.02%
2025-04-28 20:56:33,283 - contrastive_training - INFO - Current Learning rate: 0.000122
2025-04-28 20:56:33,283 - contrastive_training - INFO - Epoch [4/300], Train Loss: 3.8637, Val Loss: 3.6893, Time: 2.13s
2025-04-28 20:56:33,284 - contrastive_training - INFO - Recall@1 improved to 1.07%
2025-04-28 20:56:35,413 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.14%, R@10: 4.81%
2025-04-28 20:56:35,413 - contrastive_training - INFO - Current Learning rate: 0.000151
2025-04-28 20:56:35,413 - contrastive_training - INFO - Epoch [5/300], Train Loss: 3.8325, Val Loss: 3.5705, Time: 2.13s
2025-04-28 20:56:35,413 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:56:37,182 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:56:39,385 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.81%, R@10: 6.42%
2025-04-28 20:56:39,385 - contrastive_training - INFO - Current Learning rate: 0.000181
2025-04-28 20:56:39,385 - contrastive_training - INFO - Epoch [6/300], Train Loss: 3.7536, Val Loss: 3.5701, Time: 2.20s
2025-04-28 20:56:39,385 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 20:56:41,511 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 5.35%, R@10: 7.49%
2025-04-28 20:56:41,511 - contrastive_training - INFO - Current Learning rate: 0.000211
2025-04-28 20:56:41,511 - contrastive_training - INFO - Epoch [7/300], Train Loss: 3.6860, Val Loss: 3.6010, Time: 2.13s
2025-04-28 20:56:41,511 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 20:56:43,653 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.81%, R@10: 8.56%
2025-04-28 20:56:43,653 - contrastive_training - INFO - Current Learning rate: 0.000241
2025-04-28 20:56:43,653 - contrastive_training - INFO - Epoch [8/300], Train Loss: 3.6788, Val Loss: 3.6167, Time: 2.14s
2025-04-28 20:56:43,653 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 20:56:45,777 - contrastive_training - INFO - Recalls: R@1: 1.60%, R@5: 3.21%, R@10: 7.49%
2025-04-28 20:56:45,777 - contrastive_training - INFO - Current Learning rate: 0.000270
2025-04-28 20:56:45,777 - contrastive_training - INFO - Epoch [9/300], Train Loss: 3.6917, Val Loss: 3.6669, Time: 2.12s
2025-04-28 20:56:45,778 - contrastive_training - INFO - Recall@1 improved to 1.60%
2025-04-28 20:56:47,911 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 5.35%, R@10: 9.09%
2025-04-28 20:56:47,911 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:56:47,911 - contrastive_training - INFO - Epoch [10/300], Train Loss: 3.7169, Val Loss: 3.7245, Time: 2.13s
2025-04-28 20:56:47,911 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:56:49,865 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:56:52,014 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 4.28%, R@10: 6.95%
2025-04-28 20:56:52,014 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:56:52,014 - contrastive_training - INFO - Epoch [11/300], Train Loss: 3.7490, Val Loss: 3.7787, Time: 2.15s
2025-04-28 20:56:52,014 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 20:56:54,208 - contrastive_training - INFO - Recalls: R@1: 2.14%, R@5: 5.88%, R@10: 7.49%
2025-04-28 20:56:54,208 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:56:54,208 - contrastive_training - INFO - Epoch [12/300], Train Loss: 3.7761, Val Loss: 3.8262, Time: 2.19s
2025-04-28 20:56:54,209 - contrastive_training - INFO - Recall@1 improved to 2.14%
2025-04-28 20:56:56,349 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.81%, R@10: 7.49%
2025-04-28 20:56:56,350 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:56:56,350 - contrastive_training - INFO - Epoch [13/300], Train Loss: 3.8236, Val Loss: 3.8837, Time: 2.14s
2025-04-28 20:56:56,350 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:56:58,487 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 5.35%, R@10: 8.56%
2025-04-28 20:56:58,487 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:56:58,487 - contrastive_training - INFO - Epoch [14/300], Train Loss: 3.8614, Val Loss: 3.9142, Time: 2.14s
2025-04-28 20:56:58,487 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 20:57:00,697 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 4.28%
2025-04-28 20:57:00,698 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:57:00,698 - contrastive_training - INFO - Epoch [15/300], Train Loss: 3.9080, Val Loss: 3.9764, Time: 2.21s
2025-04-28 20:57:00,698 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:57:02,672 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 20:57:04,943 - contrastive_training - INFO - Recalls: R@1: 2.14%, R@5: 4.81%, R@10: 7.49%
2025-04-28 20:57:04,943 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:57:04,944 - contrastive_training - INFO - Epoch [16/300], Train Loss: 3.9535, Val Loss: 4.0368, Time: 2.27s
2025-04-28 20:57:04,944 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 20:57:07,098 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 6.42%
2025-04-28 20:57:07,099 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:57:07,099 - contrastive_training - INFO - Epoch [17/300], Train Loss: 4.0028, Val Loss: 4.1024, Time: 2.15s
2025-04-28 20:57:07,099 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 20:57:09,273 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 5.35%
2025-04-28 20:57:09,273 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:57:09,273 - contrastive_training - INFO - Epoch [18/300], Train Loss: 4.0490, Val Loss: 4.1227, Time: 2.17s
2025-04-28 20:57:09,273 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 20:57:11,535 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 5.35%
2025-04-28 20:57:11,535 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:57:11,535 - contrastive_training - INFO - Epoch [19/300], Train Loss: 4.1020, Val Loss: 4.1928, Time: 2.26s
2025-04-28 20:57:11,535 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 20:57:13,693 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 5.35%, R@10: 5.88%
2025-04-28 20:57:13,693 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:57:13,693 - contrastive_training - INFO - Epoch [20/300], Train Loss: 4.1548, Val Loss: 4.2924, Time: 2.16s
2025-04-28 20:57:13,693 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:57:15,742 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 20:57:17,908 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.81%, R@10: 10.70%
2025-04-28 20:57:17,908 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:57:17,908 - contrastive_training - INFO - Epoch [21/300], Train Loss: 4.2048, Val Loss: 4.3389, Time: 2.17s
2025-04-28 20:57:17,908 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 20:57:20,107 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.67%, R@10: 5.88%
2025-04-28 20:57:20,107 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:57:20,107 - contrastive_training - INFO - Epoch [22/300], Train Loss: 4.2552, Val Loss: 4.4137, Time: 2.20s
2025-04-28 20:57:20,107 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 20:57:22,298 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 5.35%, R@10: 6.95%
2025-04-28 20:57:22,298 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:57:22,298 - contrastive_training - INFO - Epoch [23/300], Train Loss: 4.2953, Val Loss: 4.4468, Time: 2.19s
2025-04-28 20:57:22,298 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 20:57:24,471 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 4.28%, R@10: 6.95%
2025-04-28 20:57:24,472 - contrastive_training - INFO - Current Learning rate: 0.000298
2025-04-28 20:57:24,472 - contrastive_training - INFO - Epoch [24/300], Train Loss: 4.3527, Val Loss: 4.5195, Time: 2.17s
2025-04-28 20:57:24,472 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 20:57:26,621 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 4.28%, R@10: 7.49%
2025-04-28 20:57:26,621 - contrastive_training - INFO - Current Learning rate: 0.000298
2025-04-28 20:57:26,622 - contrastive_training - INFO - Epoch [25/300], Train Loss: 4.4366, Val Loss: 4.4888, Time: 2.15s
2025-04-28 20:57:26,622 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:57:28,424 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 20:57:30,742 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 5.88%
2025-04-28 20:57:30,743 - contrastive_training - INFO - Current Learning rate: 0.000298
2025-04-28 20:57:30,743 - contrastive_training - INFO - Epoch [26/300], Train Loss: 4.4833, Val Loss: 4.6862, Time: 2.32s
2025-04-28 20:57:30,743 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 20:57:32,904 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 5.35%
2025-04-28 20:57:32,905 - contrastive_training - INFO - Current Learning rate: 0.000298
2025-04-28 20:57:32,905 - contrastive_training - INFO - Epoch [27/300], Train Loss: 4.5492, Val Loss: 4.6826, Time: 2.16s
2025-04-28 20:57:32,905 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 20:57:32,905 - contrastive_training - INFO - Early stopping triggered after 27 epochs
2025-04-28 20:57:32,961 - contrastive_training - INFO - 
Training Summary:
2025-04-28 20:57:32,962 - contrastive_training - INFO - Total training time: 76.25 seconds
2025-04-28 20:57:32,962 - contrastive_training - INFO - Best Recall@1: 2.14% (achieved on epoch 12)
2025-04-28 20:57:32,962 - contrastive_training - INFO - Plotting training history...
2025-04-28 20:57:33,145 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 20:57:40,561 - contrastive_training - INFO - Training completed and model saved as contrastive_model_resnet18.pth!
2025-04-28 20:57:40,561 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 20:57:40,961 - contrastive_training - INFO - Test Loss: 2.8597
2025-04-28 20:57:40,961 - contrastive_training - INFO - Top-5 matching accuracy on test set: 35.11%
