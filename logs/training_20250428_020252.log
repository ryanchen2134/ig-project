2025-04-28 02:02:52,292 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 02:02:52,292 - contrastive_training - INFO - Training parameters:
2025-04-28 02:02:52,293 - contrastive_training - INFO - Backbone architecture: resnet18
2025-04-28 02:02:52,293 - contrastive_training - INFO - Batch size: 32
2025-04-28 02:02:52,293 - contrastive_training - INFO - Embedding dimension: 64
2025-04-28 02:02:52,293 - contrastive_training - INFO - Learning rate: 5e-05
2025-04-28 02:02:52,293 - contrastive_training - INFO - Weight decay: 0.001
2025-04-28 02:02:52,297 - contrastive_training - INFO - Max epochs: 200
2025-04-28 02:02:52,297 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 02:02:52,297 - contrastive_training - INFO - NT-Xent temperature: 0.03
2025-04-28 02:02:52,297 - contrastive_training - INFO - Hard negative weight: 0.4
2025-04-28 02:02:52,297 - contrastive_training - INFO - Mixup alpha: 0.4
2025-04-28 02:02:52,320 - contrastive_training - INFO - Using device: cuda
2025-04-28 02:02:52,320 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 02:02:52,320 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 02:02:52,675 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 02:02:52,697 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 02:03:10,745 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 02:03:10,745 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 02:03:10,745 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 02:03:10,745 - contrastive_training - INFO - Actual batch sizes - Train: 32, Val: 32, Test: 32
2025-04-28 02:03:10,746 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 02:03:10,871 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-04-28 02:03:10,871 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 02:03:10,872 - contrastive_training - INFO - Starting training...
2025-04-28 02:03:10,994 - contrastive_training - INFO - Starting training on device: cuda
2025-04-28 02:03:10,994 - contrastive_training - INFO - Number of training batches: 28
2025-04-28 02:03:10,994 - contrastive_training - INFO - Number of validation batches: 6
2025-04-28 02:04:15,755 - contrastive_training - INFO - Current Learning rate: 0.000000
2025-04-28 02:04:15,755 - contrastive_training - INFO - Epoch [1/200], Train Loss: 10.0338, Val Loss: 8.4167, Time: 64.76s
2025-04-28 02:04:15,756 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:04:58,158 - contrastive_training - INFO - Validation loss improved to 8.4167
2025-04-28 02:06:02,567 - contrastive_training - INFO - Current Learning rate: 0.000005
2025-04-28 02:06:02,567 - contrastive_training - INFO - Epoch [2/200], Train Loss: 9.8689, Val Loss: 8.2169, Time: 64.41s
2025-04-28 02:06:02,567 - contrastive_training - INFO - Validation loss improved to 8.2169
2025-04-28 02:07:06,904 - contrastive_training - INFO - Current Learning rate: 0.000010
2025-04-28 02:07:06,904 - contrastive_training - INFO - Epoch [3/200], Train Loss: 9.8388, Val Loss: 8.0313, Time: 64.34s
2025-04-28 02:07:06,904 - contrastive_training - INFO - Validation loss improved to 8.0313
2025-04-28 02:08:11,079 - contrastive_training - INFO - Current Learning rate: 0.000015
2025-04-28 02:08:11,080 - contrastive_training - INFO - Epoch [4/200], Train Loss: 9.6527, Val Loss: 7.5154, Time: 64.17s
2025-04-28 02:08:11,080 - contrastive_training - INFO - Validation loss improved to 7.5154
2025-04-28 02:09:15,271 - contrastive_training - INFO - Current Learning rate: 0.000020
2025-04-28 02:09:15,271 - contrastive_training - INFO - Epoch [5/200], Train Loss: 9.0042, Val Loss: 7.1525, Time: 64.19s
2025-04-28 02:09:15,408 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_5.pth
2025-04-28 02:09:15,408 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:09:49,009 - contrastive_training - INFO - Validation loss improved to 7.1525
2025-04-28 02:10:53,462 - contrastive_training - INFO - Current Learning rate: 0.000025
2025-04-28 02:10:53,462 - contrastive_training - INFO - Epoch [6/200], Train Loss: 8.7283, Val Loss: 6.7352, Time: 64.45s
2025-04-28 02:10:53,463 - contrastive_training - INFO - Validation loss improved to 6.7352
2025-04-28 02:11:58,041 - contrastive_training - INFO - Current Learning rate: 0.000030
2025-04-28 02:11:58,041 - contrastive_training - INFO - Epoch [7/200], Train Loss: 7.9207, Val Loss: 6.3307, Time: 64.58s
2025-04-28 02:11:58,042 - contrastive_training - INFO - Validation loss improved to 6.3307
2025-04-28 02:13:03,077 - contrastive_training - INFO - Current Learning rate: 0.000035
2025-04-28 02:13:03,078 - contrastive_training - INFO - Epoch [8/200], Train Loss: 7.4387, Val Loss: 6.0911, Time: 65.04s
2025-04-28 02:13:03,078 - contrastive_training - INFO - Validation loss improved to 6.0911
2025-04-28 02:14:07,576 - contrastive_training - INFO - Current Learning rate: 0.000040
2025-04-28 02:14:07,576 - contrastive_training - INFO - Epoch [9/200], Train Loss: 7.0902, Val Loss: 5.6674, Time: 64.50s
2025-04-28 02:14:07,577 - contrastive_training - INFO - Validation loss improved to 5.6674
2025-04-28 02:15:12,184 - contrastive_training - INFO - Current Learning rate: 0.000045
2025-04-28 02:15:12,184 - contrastive_training - INFO - Epoch [10/200], Train Loss: 6.6198, Val Loss: 5.2877, Time: 64.61s
2025-04-28 02:15:12,317 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_10.pth
2025-04-28 02:15:12,317 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:15:45,843 - contrastive_training - INFO - Validation loss improved to 5.2877
2025-04-28 02:16:50,499 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:16:50,499 - contrastive_training - INFO - Epoch [11/200], Train Loss: 6.3041, Val Loss: 5.0377, Time: 64.65s
2025-04-28 02:16:50,500 - contrastive_training - INFO - Validation loss improved to 5.0377
2025-04-28 02:17:54,711 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:17:54,711 - contrastive_training - INFO - Epoch [12/200], Train Loss: 5.8911, Val Loss: 4.8292, Time: 64.21s
2025-04-28 02:17:54,712 - contrastive_training - INFO - Validation loss improved to 4.8292
2025-04-28 02:18:58,893 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:18:58,893 - contrastive_training - INFO - Epoch [13/200], Train Loss: 5.7733, Val Loss: 4.5134, Time: 64.18s
2025-04-28 02:18:58,894 - contrastive_training - INFO - Validation loss improved to 4.5134
2025-04-28 02:20:03,445 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:20:03,446 - contrastive_training - INFO - Epoch [14/200], Train Loss: 5.4204, Val Loss: 4.3477, Time: 64.55s
2025-04-28 02:20:03,446 - contrastive_training - INFO - Validation loss improved to 4.3477
2025-04-28 02:21:07,859 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:21:07,860 - contrastive_training - INFO - Epoch [15/200], Train Loss: 5.2657, Val Loss: 4.3212, Time: 64.41s
2025-04-28 02:21:07,992 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_15.pth
2025-04-28 02:21:07,992 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:21:41,510 - contrastive_training - INFO - Validation loss improved to 4.3212
2025-04-28 02:22:45,796 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:22:45,796 - contrastive_training - INFO - Epoch [16/200], Train Loss: 4.9210, Val Loss: 4.2157, Time: 64.29s
2025-04-28 02:22:45,797 - contrastive_training - INFO - Validation loss improved to 4.2157
2025-04-28 02:23:50,402 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:23:50,402 - contrastive_training - INFO - Epoch [17/200], Train Loss: 4.9247, Val Loss: 4.1969, Time: 64.61s
2025-04-28 02:23:50,403 - contrastive_training - INFO - Validation loss improved to 4.1969
2025-04-28 02:24:54,553 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:24:54,553 - contrastive_training - INFO - Epoch [18/200], Train Loss: 4.7337, Val Loss: 4.1350, Time: 64.15s
2025-04-28 02:24:54,554 - contrastive_training - INFO - Validation loss improved to 4.1350
2025-04-28 02:25:58,960 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:25:58,960 - contrastive_training - INFO - Epoch [19/200], Train Loss: 4.7603, Val Loss: 4.0436, Time: 64.41s
2025-04-28 02:25:58,961 - contrastive_training - INFO - Validation loss improved to 4.0436
2025-04-28 02:27:03,536 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:27:03,536 - contrastive_training - INFO - Epoch [20/200], Train Loss: 4.4824, Val Loss: 3.9601, Time: 64.58s
2025-04-28 02:27:03,672 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_20.pth
2025-04-28 02:27:03,672 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:27:37,429 - contrastive_training - INFO - Validation loss improved to 3.9601
2025-04-28 02:28:41,879 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:28:41,879 - contrastive_training - INFO - Epoch [21/200], Train Loss: 4.2846, Val Loss: 3.9305, Time: 64.45s
2025-04-28 02:28:41,880 - contrastive_training - INFO - Validation loss improved to 3.9305
2025-04-28 02:29:46,686 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:29:46,686 - contrastive_training - INFO - Epoch [22/200], Train Loss: 4.0904, Val Loss: 3.9407, Time: 64.81s
2025-04-28 02:29:46,686 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 02:30:51,229 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:30:51,229 - contrastive_training - INFO - Epoch [23/200], Train Loss: 4.1595, Val Loss: 3.9504, Time: 64.54s
2025-04-28 02:30:51,229 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 02:31:55,644 - contrastive_training - INFO - Current Learning rate: 0.000050
2025-04-28 02:31:55,644 - contrastive_training - INFO - Epoch [24/200], Train Loss: 4.2344, Val Loss: 3.9131, Time: 64.41s
2025-04-28 02:31:55,645 - contrastive_training - INFO - Validation loss improved to 3.9131
2025-04-28 02:33:00,057 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:33:00,057 - contrastive_training - INFO - Epoch [25/200], Train Loss: 4.0078, Val Loss: 3.8839, Time: 64.41s
2025-04-28 02:33:00,195 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_25.pth
2025-04-28 02:33:00,195 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:33:33,758 - contrastive_training - INFO - Validation loss improved to 3.8839
2025-04-28 02:34:40,022 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:34:40,022 - contrastive_training - INFO - Epoch [26/200], Train Loss: 3.8900, Val Loss: 3.8742, Time: 66.26s
2025-04-28 02:34:40,023 - contrastive_training - INFO - Validation loss improved to 3.8742
2025-04-28 02:35:45,152 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:35:45,153 - contrastive_training - INFO - Epoch [27/200], Train Loss: 3.8127, Val Loss: 3.8808, Time: 65.13s
2025-04-28 02:35:45,153 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 02:36:50,374 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:36:50,375 - contrastive_training - INFO - Epoch [28/200], Train Loss: 3.7607, Val Loss: 3.8639, Time: 65.22s
2025-04-28 02:36:50,376 - contrastive_training - INFO - Validation loss improved to 3.8639
2025-04-28 02:37:55,547 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:37:55,547 - contrastive_training - INFO - Epoch [29/200], Train Loss: 3.5866, Val Loss: 3.8727, Time: 65.17s
2025-04-28 02:37:55,547 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 02:39:01,111 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:39:01,111 - contrastive_training - INFO - Epoch [30/200], Train Loss: 3.5710, Val Loss: 3.8902, Time: 65.56s
2025-04-28 02:39:01,246 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_30.pth
2025-04-28 02:39:01,246 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:39:35,189 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 02:40:40,486 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:40:40,486 - contrastive_training - INFO - Epoch [31/200], Train Loss: 3.4026, Val Loss: 3.9151, Time: 65.30s
2025-04-28 02:40:40,486 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 02:41:45,877 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:41:45,879 - contrastive_training - INFO - Epoch [32/200], Train Loss: 3.3651, Val Loss: 3.9202, Time: 65.39s
2025-04-28 02:41:45,879 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 02:42:51,259 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:42:51,259 - contrastive_training - INFO - Epoch [33/200], Train Loss: 3.2768, Val Loss: 4.0035, Time: 65.38s
2025-04-28 02:42:51,259 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 02:43:57,045 - contrastive_training - INFO - Current Learning rate: 0.000049
2025-04-28 02:43:57,045 - contrastive_training - INFO - Epoch [34/200], Train Loss: 3.2213, Val Loss: 3.9134, Time: 65.79s
2025-04-28 02:43:57,045 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 02:45:02,633 - contrastive_training - INFO - Current Learning rate: 0.000048
2025-04-28 02:45:02,633 - contrastive_training - INFO - Epoch [35/200], Train Loss: 3.0595, Val Loss: 3.9325, Time: 65.59s
2025-04-28 02:45:02,771 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_35.pth
2025-04-28 02:45:02,771 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:45:36,745 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 02:46:42,360 - contrastive_training - INFO - Current Learning rate: 0.000048
2025-04-28 02:46:42,361 - contrastive_training - INFO - Epoch [36/200], Train Loss: 3.0272, Val Loss: 3.9651, Time: 65.62s
2025-04-28 02:46:42,361 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 02:47:47,766 - contrastive_training - INFO - Current Learning rate: 0.000048
2025-04-28 02:47:47,766 - contrastive_training - INFO - Epoch [37/200], Train Loss: 3.0989, Val Loss: 4.0498, Time: 65.40s
2025-04-28 02:47:47,766 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 02:48:53,145 - contrastive_training - INFO - Current Learning rate: 0.000048
2025-04-28 02:48:53,145 - contrastive_training - INFO - Epoch [38/200], Train Loss: 3.0409, Val Loss: 4.0460, Time: 65.38s
2025-04-28 02:48:53,145 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 02:49:58,511 - contrastive_training - INFO - Current Learning rate: 0.000048
2025-04-28 02:49:58,512 - contrastive_training - INFO - Epoch [39/200], Train Loss: 2.9751, Val Loss: 4.0759, Time: 65.37s
2025-04-28 02:49:58,512 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 02:51:03,491 - contrastive_training - INFO - Current Learning rate: 0.000048
2025-04-28 02:51:03,491 - contrastive_training - INFO - Epoch [40/200], Train Loss: 2.8762, Val Loss: 4.0466, Time: 64.98s
2025-04-28 02:51:03,627 - contrastive_training - INFO - Checkpoint saved to checkpoints\checkpoint_epoch_40.pth
2025-04-28 02:51:03,627 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 02:51:37,594 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 02:52:43,051 - contrastive_training - INFO - Current Learning rate: 0.000048
2025-04-28 02:52:43,052 - contrastive_training - INFO - Epoch [41/200], Train Loss: 2.6604, Val Loss: 4.1085, Time: 65.46s
2025-04-28 02:52:43,052 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 02:53:48,228 - contrastive_training - INFO - Current Learning rate: 0.000047
2025-04-28 02:53:48,228 - contrastive_training - INFO - Epoch [42/200], Train Loss: 2.8263, Val Loss: 4.1342, Time: 65.18s
2025-04-28 02:53:48,228 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 02:54:53,586 - contrastive_training - INFO - Current Learning rate: 0.000047
2025-04-28 02:54:53,586 - contrastive_training - INFO - Epoch [43/200], Train Loss: 2.6172, Val Loss: 4.0949, Time: 65.36s
2025-04-28 02:54:53,586 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 02:54:53,586 - contrastive_training - INFO - Early stopping triggered after 43 epochs
2025-04-28 02:54:53,636 - contrastive_training - INFO - Best model saved to checkpoints\best_model.pth
2025-04-28 02:54:53,636 - contrastive_training - INFO - 
Training Summary:
2025-04-28 02:54:53,636 - contrastive_training - INFO - Total training time: 3102.64 seconds
2025-04-28 02:54:53,637 - contrastive_training - INFO - Best validation loss: 3.8639 (achieved on epoch 28)
2025-04-28 02:54:53,637 - contrastive_training - INFO - Plotting training history...
2025-04-28 02:54:53,847 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 02:59:45,335 - contrastive_training - INFO - Training completed and model saved as contrastive_model_resnet18.pth!
2025-04-28 02:59:45,335 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 03:00:18,116 - contrastive_training - INFO - Test Loss: 3.9154
2025-04-28 03:00:50,488 - contrastive_training - INFO - Matching accuracy on test set: 4.79%
