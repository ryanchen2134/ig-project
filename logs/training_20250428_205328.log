2025-04-28 20:53:28,873 - contrastive_training - INFO - Random seeds set for reproducibility
2025-04-28 20:53:28,873 - contrastive_training - INFO - Training parameters:
2025-04-28 20:53:28,873 - contrastive_training - INFO - Backbone architecture: efficientnet_b0
2025-04-28 20:53:28,873 - contrastive_training - INFO - Batch size: 64
2025-04-28 20:53:28,873 - contrastive_training - INFO - Embedding dimension: 128
2025-04-28 20:53:28,873 - contrastive_training - INFO - Learning rate: 0.0003
2025-04-28 20:53:28,873 - contrastive_training - INFO - Weight decay: 0.0001
2025-04-28 20:53:28,873 - contrastive_training - INFO - Max epochs: 300
2025-04-28 20:53:28,873 - contrastive_training - INFO - Early stopping patience: 15
2025-04-28 20:53:28,873 - contrastive_training - INFO - NT-Xent temperature: 0.05
2025-04-28 20:53:28,873 - contrastive_training - INFO - Hard negative weight: 0.2
2025-04-28 20:53:28,873 - contrastive_training - INFO - Mixup alpha: 0.4
2025-04-28 20:53:28,886 - contrastive_training - INFO - Using device: cuda
2025-04-28 20:53:28,887 - contrastive_training - INFO - Data path: data/csv files/rawr_dinosaur.csv
2025-04-28 20:53:28,887 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-04-28 20:53:29,141 - contrastive_training - INFO - Dataset successfully loaded with 1247 samples
2025-04-28 20:53:29,161 - contrastive_training - INFO - Song embedding dimension: 128
2025-04-28 20:53:45,578 - contrastive_training - INFO - Train set: 872 samples
2025-04-28 20:53:45,578 - contrastive_training - INFO - Validation set: 187 samples
2025-04-28 20:53:45,578 - contrastive_training - INFO - Test set: 188 samples
2025-04-28 20:53:45,578 - contrastive_training - INFO - Actual batch sizes - Train: 64, Val: 64, Test: 64
2025-04-28 20:53:45,578 - contrastive_training - INFO - DataLoaders created successfully
2025-04-28 20:53:45,646 - contrastive_training - INFO - Model initialized successfully with efficientnet_b0 backbone
2025-04-28 20:53:45,647 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-04-28 20:53:45,647 - contrastive_training - INFO - Starting training...
2025-04-28 20:53:45,736 - contrastive_training - INFO - Starting enhanced training on device: cuda
2025-04-28 20:53:48,650 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.14%, R@10: 3.21%
2025-04-28 20:53:48,650 - contrastive_training - INFO - Current Learning rate: 0.000033
2025-04-28 20:53:48,650 - contrastive_training - INFO - Epoch [1/300], Train Loss: 5.7091, Val Loss: 5.7504, Time: 2.91s
2025-04-28 20:53:48,650 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:53:56,098 - contrastive_training - INFO - Recall@1 improved to 0.53%
2025-04-28 20:53:58,663 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 2.67%
2025-04-28 20:53:58,663 - contrastive_training - INFO - Current Learning rate: 0.000062
2025-04-28 20:53:58,663 - contrastive_training - INFO - Epoch [2/300], Train Loss: 5.7640, Val Loss: 5.6948, Time: 2.57s
2025-04-28 20:53:58,663 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:54:01,139 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 4.81%
2025-04-28 20:54:01,139 - contrastive_training - INFO - Current Learning rate: 0.000092
2025-04-28 20:54:01,139 - contrastive_training - INFO - Epoch [3/300], Train Loss: 5.7357, Val Loss: 5.5692, Time: 2.48s
2025-04-28 20:54:01,141 - contrastive_training - INFO - Recall@1 improved to 1.07%
2025-04-28 20:54:03,706 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.74%, R@10: 5.35%
2025-04-28 20:54:03,706 - contrastive_training - INFO - Current Learning rate: 0.000122
2025-04-28 20:54:03,706 - contrastive_training - INFO - Epoch [4/300], Train Loss: 5.5208, Val Loss: 5.3813, Time: 2.56s
2025-04-28 20:54:03,706 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:54:06,195 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 4.81%, R@10: 7.49%
2025-04-28 20:54:06,196 - contrastive_training - INFO - Current Learning rate: 0.000151
2025-04-28 20:54:06,196 - contrastive_training - INFO - Epoch [5/300], Train Loss: 5.3656, Val Loss: 5.1175, Time: 2.49s
2025-04-28 20:54:06,196 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:54:08,065 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 20:54:10,571 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.74%, R@10: 7.49%
2025-04-28 20:54:10,571 - contrastive_training - INFO - Current Learning rate: 0.000181
2025-04-28 20:54:10,571 - contrastive_training - INFO - Epoch [6/300], Train Loss: 5.1464, Val Loss: 4.8282, Time: 2.51s
2025-04-28 20:54:10,571 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 20:54:13,123 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.21%, R@10: 6.42%
2025-04-28 20:54:13,123 - contrastive_training - INFO - Current Learning rate: 0.000211
2025-04-28 20:54:13,123 - contrastive_training - INFO - Epoch [7/300], Train Loss: 4.9986, Val Loss: 4.6640, Time: 2.55s
2025-04-28 20:54:13,124 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 20:54:15,803 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 6.42%, R@10: 6.95%
2025-04-28 20:54:15,803 - contrastive_training - INFO - Current Learning rate: 0.000241
2025-04-28 20:54:15,804 - contrastive_training - INFO - Epoch [8/300], Train Loss: 4.8470, Val Loss: 4.5772, Time: 2.68s
2025-04-28 20:54:15,804 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 20:54:18,512 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 6.95%
2025-04-28 20:54:18,512 - contrastive_training - INFO - Current Learning rate: 0.000270
2025-04-28 20:54:18,512 - contrastive_training - INFO - Epoch [9/300], Train Loss: 4.7282, Val Loss: 4.5225, Time: 2.71s
2025-04-28 20:54:18,512 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 20:54:21,110 - contrastive_training - INFO - Recalls: R@1: 1.60%, R@5: 4.81%, R@10: 8.02%
2025-04-28 20:54:21,110 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:21,110 - contrastive_training - INFO - Epoch [10/300], Train Loss: 4.6512, Val Loss: 4.4928, Time: 2.60s
2025-04-28 20:54:21,110 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:54:22,978 - contrastive_training - INFO - Recall@1 improved to 1.60%
2025-04-28 20:54:25,662 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 5.88%
2025-04-28 20:54:25,663 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:25,663 - contrastive_training - INFO - Epoch [11/300], Train Loss: 4.5862, Val Loss: 4.4849, Time: 2.68s
2025-04-28 20:54:25,663 - contrastive_training - INFO - No improvement for 1 epochs
2025-04-28 20:54:28,338 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.14%, R@10: 3.74%
2025-04-28 20:54:28,338 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:28,338 - contrastive_training - INFO - Epoch [12/300], Train Loss: 4.5681, Val Loss: 4.4913, Time: 2.68s
2025-04-28 20:54:28,338 - contrastive_training - INFO - No improvement for 2 epochs
2025-04-28 20:54:30,963 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 4.81%
2025-04-28 20:54:30,964 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:30,964 - contrastive_training - INFO - Epoch [13/300], Train Loss: 4.5597, Val Loss: 4.4943, Time: 2.63s
2025-04-28 20:54:30,964 - contrastive_training - INFO - No improvement for 3 epochs
2025-04-28 20:54:33,586 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 5.35%
2025-04-28 20:54:33,586 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:33,586 - contrastive_training - INFO - Epoch [14/300], Train Loss: 4.5491, Val Loss: 4.4991, Time: 2.62s
2025-04-28 20:54:33,586 - contrastive_training - INFO - No improvement for 4 epochs
2025-04-28 20:54:36,265 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 4.81%
2025-04-28 20:54:36,265 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:36,265 - contrastive_training - INFO - Epoch [15/300], Train Loss: 4.5457, Val Loss: 4.4968, Time: 2.68s
2025-04-28 20:54:36,265 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:54:38,233 - contrastive_training - INFO - No improvement for 5 epochs
2025-04-28 20:54:40,844 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 2.67%, R@10: 5.88%
2025-04-28 20:54:40,845 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:40,845 - contrastive_training - INFO - Epoch [16/300], Train Loss: 4.5477, Val Loss: 4.4970, Time: 2.61s
2025-04-28 20:54:40,845 - contrastive_training - INFO - No improvement for 6 epochs
2025-04-28 20:54:43,371 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 1.60%, R@10: 4.81%
2025-04-28 20:54:43,371 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-04-28 20:54:43,371 - contrastive_training - INFO - Epoch [17/300], Train Loss: 4.5419, Val Loss: 4.5022, Time: 2.53s
2025-04-28 20:54:43,371 - contrastive_training - INFO - No improvement for 7 epochs
2025-04-28 20:54:45,971 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.21%, R@10: 5.35%
2025-04-28 20:54:45,971 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:54:45,971 - contrastive_training - INFO - Epoch [18/300], Train Loss: 4.5414, Val Loss: 4.5052, Time: 2.60s
2025-04-28 20:54:45,972 - contrastive_training - INFO - No improvement for 8 epochs
2025-04-28 20:54:48,488 - contrastive_training - INFO - Recalls: R@1: 1.07%, R@5: 3.74%, R@10: 6.42%
2025-04-28 20:54:48,488 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:54:48,489 - contrastive_training - INFO - Epoch [19/300], Train Loss: 4.5415, Val Loss: 4.5058, Time: 2.52s
2025-04-28 20:54:48,489 - contrastive_training - INFO - No improvement for 9 epochs
2025-04-28 20:54:51,130 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 3.74%, R@10: 7.49%
2025-04-28 20:54:51,130 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:54:51,130 - contrastive_training - INFO - Epoch [20/300], Train Loss: 4.5399, Val Loss: 4.5115, Time: 2.64s
2025-04-28 20:54:51,130 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:54:53,237 - contrastive_training - INFO - No improvement for 10 epochs
2025-04-28 20:54:55,840 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.14%, R@10: 4.28%
2025-04-28 20:54:55,840 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:54:55,840 - contrastive_training - INFO - Epoch [21/300], Train Loss: 4.5403, Val Loss: 4.5130, Time: 2.60s
2025-04-28 20:54:55,840 - contrastive_training - INFO - No improvement for 11 epochs
2025-04-28 20:54:58,351 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.14%, R@10: 4.81%
2025-04-28 20:54:58,351 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:54:58,351 - contrastive_training - INFO - Epoch [22/300], Train Loss: 4.5386, Val Loss: 4.5156, Time: 2.51s
2025-04-28 20:54:58,351 - contrastive_training - INFO - No improvement for 12 epochs
2025-04-28 20:55:00,934 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.14%, R@10: 4.81%
2025-04-28 20:55:00,935 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-04-28 20:55:00,935 - contrastive_training - INFO - Epoch [23/300], Train Loss: 4.5454, Val Loss: 4.5212, Time: 2.58s
2025-04-28 20:55:00,935 - contrastive_training - INFO - No improvement for 13 epochs
2025-04-28 20:55:03,446 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 4.81%
2025-04-28 20:55:03,446 - contrastive_training - INFO - Current Learning rate: 0.000298
2025-04-28 20:55:03,446 - contrastive_training - INFO - Epoch [24/300], Train Loss: 4.5451, Val Loss: 4.5279, Time: 2.51s
2025-04-28 20:55:03,446 - contrastive_training - INFO - No improvement for 14 epochs
2025-04-28 20:55:06,031 - contrastive_training - INFO - Recalls: R@1: 0.53%, R@5: 2.67%, R@10: 5.88%
2025-04-28 20:55:06,031 - contrastive_training - INFO - Current Learning rate: 0.000298
2025-04-28 20:55:06,031 - contrastive_training - INFO - Epoch [25/300], Train Loss: 4.5513, Val Loss: 4.5323, Time: 2.58s
2025-04-28 20:55:06,031 - contrastive_training - INFO - Creating embedding visualizations...
2025-04-28 20:55:07,978 - contrastive_training - INFO - No improvement for 15 epochs
2025-04-28 20:55:07,978 - contrastive_training - INFO - Early stopping triggered after 25 epochs
2025-04-28 20:55:08,017 - contrastive_training - INFO - 
Training Summary:
2025-04-28 20:55:08,017 - contrastive_training - INFO - Total training time: 82.28 seconds
2025-04-28 20:55:08,017 - contrastive_training - INFO - Best Recall@1: 1.60% (achieved on epoch 10)
2025-04-28 20:55:08,017 - contrastive_training - INFO - Plotting training history...
2025-04-28 20:55:08,197 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-04-28 20:55:22,946 - contrastive_training - INFO - Training completed and model saved as contrastive_model_efficientnet_b0.pth!
2025-04-28 20:55:22,946 - contrastive_training - INFO - 
Evaluating on test set...
2025-04-28 20:55:23,364 - contrastive_training - INFO - Test Loss: 4.2327
2025-04-28 20:55:23,364 - contrastive_training - INFO - Top-5 matching accuracy on test set: 11.70%
