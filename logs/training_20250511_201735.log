2025-05-11 20:17:35,973 - contrastive_training - INFO - Random seeds set for reproducibility
2025-05-11 20:17:35,973 - contrastive_training - INFO - Training parameters:
2025-05-11 20:17:35,973 - contrastive_training - INFO - Backbone architecture: resnet18
2025-05-11 20:17:35,973 - contrastive_training - INFO - Batch size: 16
2025-05-11 20:17:35,973 - contrastive_training - INFO - Embedding dimension: 64
2025-05-11 20:17:35,973 - contrastive_training - INFO - Learning rate: 0.0003
2025-05-11 20:17:35,973 - contrastive_training - INFO - Weight decay: 0.0001
2025-05-11 20:17:35,973 - contrastive_training - INFO - Max epochs: 75
2025-05-11 20:17:35,973 - contrastive_training - INFO - Early stopping patience: 10
2025-05-11 20:17:35,973 - contrastive_training - INFO - NT-Xent temperature: 0.07
2025-05-11 20:17:35,973 - contrastive_training - INFO - Hard negative weight: 0.05
2025-05-11 20:17:35,973 - contrastive_training - INFO - Mixup alpha: 0.2
2025-05-11 20:17:35,985 - contrastive_training - INFO - Using device: cuda
2025-05-11 20:17:35,985 - contrastive_training - INFO - Data path: data/csv_files/data_cleaned.csv
2025-05-11 20:17:35,985 - contrastive_training - INFO - Image folder: data/final-sample-dataset/images
2025-05-11 20:17:36,111 - contrastive_training - INFO - Dataset successfully loaded with 1177 samples
2025-05-11 20:17:36,131 - contrastive_training - INFO - Song embedding dimension: 64
2025-05-11 20:17:52,514 - contrastive_training - INFO - Train set: 823 samples
2025-05-11 20:17:52,514 - contrastive_training - INFO - Validation set: 177 samples
2025-05-11 20:17:52,515 - contrastive_training - INFO - Test set: 177 samples
2025-05-11 20:17:52,515 - contrastive_training - INFO - Actual batch sizes - Train: 16, Val: 16, Test: 16
2025-05-11 20:17:52,515 - contrastive_training - INFO - DataLoaders created successfully
2025-05-11 20:17:52,645 - contrastive_training - INFO - Model initialized successfully with resnet18 backbone
2025-05-11 20:17:52,646 - contrastive_training - INFO - Optimizer and scheduler initialized
2025-05-11 20:17:52,646 - contrastive_training - INFO - Starting training...
2025-05-11 20:17:52,733 - contrastive_training - INFO - Starting enhanced training on device: cuda
2025-05-11 20:17:54,278 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 3.39%, R@10: 5.08%
2025-05-11 20:17:54,278 - contrastive_training - INFO - Current Learning rate: 0.000033
2025-05-11 20:17:54,278 - contrastive_training - INFO - Epoch [1/75], Train Loss: 4.7212, Val Loss: 4.1166, Time: 1.55s
2025-05-11 20:17:54,278 - contrastive_training - INFO - Creating embedding visualizations...
2025-05-11 20:18:01,920 - contrastive_training - INFO - No improvement for 1 epochs
2025-05-11 20:18:03,137 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.26%, R@10: 4.52%
2025-05-11 20:18:03,137 - contrastive_training - INFO - Current Learning rate: 0.000062
2025-05-11 20:18:03,137 - contrastive_training - INFO - Epoch [2/75], Train Loss: 4.4690, Val Loss: 3.5772, Time: 1.22s
2025-05-11 20:18:03,137 - contrastive_training - INFO - No improvement for 2 epochs
2025-05-11 20:18:04,388 - contrastive_training - INFO - Recalls: R@1: 0.56%, R@5: 2.26%, R@10: 3.95%
2025-05-11 20:18:04,388 - contrastive_training - INFO - Current Learning rate: 0.000092
2025-05-11 20:18:04,388 - contrastive_training - INFO - Epoch [3/75], Train Loss: 3.7618, Val Loss: 3.0606, Time: 1.25s
2025-05-11 20:18:04,389 - contrastive_training - INFO - Recall@1 improved to 0.56%
2025-05-11 20:18:05,630 - contrastive_training - INFO - Recalls: R@1: 0.56%, R@5: 2.26%, R@10: 5.65%
2025-05-11 20:18:05,630 - contrastive_training - INFO - Current Learning rate: 0.000122
2025-05-11 20:18:05,630 - contrastive_training - INFO - Epoch [4/75], Train Loss: 3.3407, Val Loss: 2.8338, Time: 1.24s
2025-05-11 20:18:05,630 - contrastive_training - INFO - No improvement for 1 epochs
2025-05-11 20:18:06,933 - contrastive_training - INFO - Recalls: R@1: 0.56%, R@5: 1.69%, R@10: 5.65%
2025-05-11 20:18:06,933 - contrastive_training - INFO - Current Learning rate: 0.000151
2025-05-11 20:18:06,933 - contrastive_training - INFO - Epoch [5/75], Train Loss: 3.1598, Val Loss: 2.7693, Time: 1.30s
2025-05-11 20:18:06,933 - contrastive_training - INFO - Creating embedding visualizations...
2025-05-11 20:18:08,825 - contrastive_training - INFO - No improvement for 2 epochs
2025-05-11 20:18:10,181 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.26%, R@10: 7.34%
2025-05-11 20:18:10,182 - contrastive_training - INFO - Current Learning rate: 0.000181
2025-05-11 20:18:10,182 - contrastive_training - INFO - Epoch [6/75], Train Loss: 3.0880, Val Loss: 2.7404, Time: 1.36s
2025-05-11 20:18:10,182 - contrastive_training - INFO - No improvement for 3 epochs
2025-05-11 20:18:11,427 - contrastive_training - INFO - Recalls: R@1: 0.56%, R@5: 2.26%, R@10: 5.65%
2025-05-11 20:18:11,427 - contrastive_training - INFO - Current Learning rate: 0.000211
2025-05-11 20:18:11,427 - contrastive_training - INFO - Epoch [7/75], Train Loss: 3.0404, Val Loss: 2.7302, Time: 1.25s
2025-05-11 20:18:11,427 - contrastive_training - INFO - No improvement for 4 epochs
2025-05-11 20:18:12,632 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.82%, R@10: 5.08%
2025-05-11 20:18:12,632 - contrastive_training - INFO - Current Learning rate: 0.000241
2025-05-11 20:18:12,632 - contrastive_training - INFO - Epoch [8/75], Train Loss: 3.0279, Val Loss: 2.7261, Time: 1.20s
2025-05-11 20:18:12,632 - contrastive_training - INFO - No improvement for 5 epochs
2025-05-11 20:18:13,837 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.26%, R@10: 5.65%
2025-05-11 20:18:13,837 - contrastive_training - INFO - Current Learning rate: 0.000270
2025-05-11 20:18:13,837 - contrastive_training - INFO - Epoch [9/75], Train Loss: 3.0142, Val Loss: 2.7230, Time: 1.21s
2025-05-11 20:18:13,837 - contrastive_training - INFO - No improvement for 6 epochs
2025-05-11 20:18:15,082 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 2.26%, R@10: 7.34%
2025-05-11 20:18:15,082 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-05-11 20:18:15,082 - contrastive_training - INFO - Epoch [10/75], Train Loss: 3.0057, Val Loss: 2.7223, Time: 1.24s
2025-05-11 20:18:15,082 - contrastive_training - INFO - Creating embedding visualizations...
2025-05-11 20:18:16,908 - contrastive_training - INFO - No improvement for 7 epochs
2025-05-11 20:18:18,136 - contrastive_training - INFO - Recalls: R@1: 0.00%, R@5: 4.52%, R@10: 6.78%
2025-05-11 20:18:18,136 - contrastive_training - INFO - Current Learning rate: 0.000300
2025-05-11 20:18:18,136 - contrastive_training - INFO - Epoch [11/75], Train Loss: 3.0041, Val Loss: 2.7228, Time: 1.23s
2025-05-11 20:18:18,136 - contrastive_training - INFO - No improvement for 8 epochs
2025-05-11 20:18:19,361 - contrastive_training - INFO - Recalls: R@1: 0.56%, R@5: 2.26%, R@10: 7.91%
2025-05-11 20:18:19,361 - contrastive_training - INFO - Current Learning rate: 0.000299
2025-05-11 20:18:19,361 - contrastive_training - INFO - Epoch [12/75], Train Loss: 2.9957, Val Loss: 2.7244, Time: 1.23s
2025-05-11 20:18:19,361 - contrastive_training - INFO - No improvement for 9 epochs
2025-05-11 20:18:20,580 - contrastive_training - INFO - Recalls: R@1: 0.56%, R@5: 3.39%, R@10: 8.47%
2025-05-11 20:18:20,580 - contrastive_training - INFO - Current Learning rate: 0.000298
2025-05-11 20:18:20,580 - contrastive_training - INFO - Epoch [13/75], Train Loss: 3.0001, Val Loss: 2.7253, Time: 1.22s
2025-05-11 20:18:20,580 - contrastive_training - INFO - No improvement for 10 epochs
2025-05-11 20:18:20,580 - contrastive_training - INFO - Early stopping triggered after 13 epochs
2025-05-11 20:18:20,636 - contrastive_training - INFO - 
Training Summary:
2025-05-11 20:18:20,636 - contrastive_training - INFO - Total training time: 27.90 seconds
2025-05-11 20:18:20,636 - contrastive_training - INFO - Best Recall@1: 0.56% (achieved on epoch 3)
2025-05-11 20:18:20,636 - contrastive_training - INFO - Plotting training history...
2025-05-11 20:18:20,830 - contrastive_training - INFO - Training history plot saved to contrastive_training_history.png
2025-05-11 20:18:23,720 - contrastive_training - INFO - Training completed and model saved as contrastive_model_resnet18.pth!
2025-05-11 20:18:23,720 - contrastive_training - INFO - 
Evaluating on test set...
2025-05-11 20:18:24,066 - contrastive_training - INFO - Test Loss: 2.6288
2025-05-11 20:18:24,066 - contrastive_training - INFO - Top-5 matching accuracy on test set: 31.64%
